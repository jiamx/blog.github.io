<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录朴实无华且枯燥的生活"><title>第六篇|Spark MLLib机器学习(1) | Jmx's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '912b6cfc43243cd27aeb428f7dbf7823';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="/js/toc.js?v=0.0.0"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">第六篇|Spark MLLib机器学习(1)</h1><a id="logo" href="/.">Jmx's Blog</a><p class="description">Keep it Simple and Stupid!</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-pied-piper-alt"> 关于</i></a><a href="/tags"><i class="fa fa-tags"> 标签</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">第六篇|Spark MLLib机器学习(1)</h1><div class="post-meta">Jul 31, 2020<span> | </span><span class="category"><a href="/categories/Spark/">Spark</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.4k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 8</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><a id="more"></a>

<p>MLlib是Spark提供的一个机器学习库，通过调用MLlib封装好的算法，可以轻松地构建机器学习应用。它提供了非常丰富的机器学习算法，比如分类、回归、聚类及推荐算法。除此之外，MLlib对用于机器学习算法的API进行了标准化，从而使将多种算法组合到单个Pipeline或工作流中变得更加容易。通过本文，你可以了解到：</p>
<ul>
<li>什么是机器学习</li>
<li>大数据与机器学习</li>
<li>机器学习分类</li>
<li>Spark MLLib介绍</li>
</ul>
<blockquote>
<p>机器学习是人工智能的一个分支，是一门多领域交叉学科，涉及概率论、统计学、逼近论、凸分析、计算复杂性理论等多门学科。机器学习理论主要是设计和分析一些让计算机可以自动“学习”的算法。因为学习算法中涉及了大量的统计学理论，机器学习与推断统计学联系尤为密切，也被称为统计学习理论。算法设计方面，机器学习理论关注可以实现的，行之有效的学习算法。</p>
<p>来源：Mitchell, T. (1997). Machine Learning. McGraw Hill.</p>
</blockquote>
<h2 id="什么是机器学习"><a href="#什么是机器学习" class="headerlink" title="什么是机器学习"></a>什么是机器学习</h2><p><img src="//jiamaoxiang.top/2020/07/31/第六篇-Spark-MLLib机器学习/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A01.png" alt></p>
<p>机器学习的应用已遍及人工智能的各个分支，如专家系统、自动推理、自然语言理解、模式识别、计算机视觉、智能机器人等领域。机器学习是人工智能的一个分支学科，主要研究的是让机器从过去的经历中学习经验，对数据的不确定性进行建模，对未来进行预测。机器学习应用的领域很多，比如搜索、推荐系统、垃圾邮件过滤、人脸识别、语音识别等等。</p>
<h2 id="大数据与机器学习"><a href="#大数据与机器学习" class="headerlink" title="大数据与机器学习"></a>大数据与机器学习</h2><p>大数据时代，数据产生的速度是非常惊人的。互联网、移动互联网、物联网、GPS等等都会在无时无刻产生着数据。处理这些数据所需要的存储与计算的能力也在成几何级增长，由此诞生了一系列的以Hadoop为代表的大数据技术，这些大数据技术为处理和存储这些数据提供了可靠的保障。</p>
<p>数据、信息、知识是由大到小的三个层次。单纯的数据很难说明一些问题，需要加之人们的一些经验，将其转换为信息，所谓信息，也就是为了消除不确定性，我们常说信息不对称，指的就是在不能够获取足够的信息时，很难消除一些不确定的因素。而知识则是最高阶段，所以数据挖掘也叫知识发现。</p>
<p>机器学习的任务就是利用一些算法，作用于大数据，然后挖掘背后所蕴含的潜在的知识。训练的数据越多，机器学习就越能体现出优势，以前机器学习解决不了的问题，现在通过大数据技术可以得到很好的解决，性能也会大幅度提升，如语音识别、图像识别等等。</p>
<h2 id="机器学习分类"><a href="#机器学习分类" class="headerlink" title="机器学习分类"></a>机器学习分类</h2><p>机器学习主要分为下面几大类：</p>
<ul>
<li><p><strong>监督学习(supervised learning)</strong></p>
<p>基本上是分类的同义词。学习中的<code>监督</code>来自训练数据集中标记的实例。比如，在邮政编码识别问题中，一组手写邮政编码图像与其对应的机器可读的转换物用作训练实例，监督分类模型的学习。常见的监督学习算法包括：线性回归、逻辑回归、决策树、朴素贝叶斯、支持向量机等等。</p>
</li>
<li><p><strong>无监督学习(unsupervised learning)</strong></p>
<p>本质上是聚类的同义词。学习过程是无监督的，因为输入实例没有类标记。无监督学习的任务是从给定的数据集中，挖掘出潜在的结构。比如，把猫和狗的照片给机器，不给这些照片打任何标签，但是希望机器能够将这些照片分分类，最终机器会把这些照片分为两大类，但是并不知道哪些是猫的照片，哪些是狗的照片，对于机器来说，相当于分成了 A、B 两类。常见的无监督学习算法包括：K-means 聚类、主成分分析(PCA)等。</p>
</li>
<li><p><strong>半监督学习(Semi-supervised learning)</strong></p>
<p>半监督学习是一类机器学习技术，在学习模型时，它使用标记的和未标记的实例。让学习器不依赖外界交互、自动地利用未标记样本来提升学习性能，就是半监督学习。</p>
<p> 半监督学习的现实需求非常强烈，因为在现实应用中往往能容易地收集到大量未标记样本，而获取<code>标记</code>却需耗费人力、物力。例如，在进行计算机辅助医学影像分析时，可以从医院获得大量医学影像， 但若希望医学专家把影像中的病灶全都标识出来则是不现实的<code>有标记数据少，未标记数据多</code>这个现象在互联网应用中更明显，例如在进行网页推荐时需请用户标记出感兴趣的网页， 但很少有用户愿花很多时间来提供标记，因此，有标记网页样本少，但互联网上存在无数网页可作为未标记样本来使用。</p>
</li>
<li><p><strong>强化学习(reinforcement learning)</strong></p>
<p>又称再励学习、评价学习，是一种重要的机器学习方法，在智能控制机器人及分析预测等领域有许多应用。强化学习的常见模型是标准的马尔可夫决策过程（Markov Decision Process, MDP)。</p>
</li>
</ul>
<h2 id="Spark-MLLib介绍"><a href="#Spark-MLLib介绍" class="headerlink" title="Spark MLLib介绍"></a>Spark MLLib介绍</h2><p>MLlib是Spark的机器学习库，通过该库可以简化机器学习的工程实践工作。MLlib包含了非常丰富的机器学习算法：分类、回归、聚类、协同过滤、主成分分析等等。目前，MLlib分为两个代码包：<strong>spark.mllib</strong>与<strong>spark.ml</strong>。</p>
<h3 id="spark-mllib"><a href="#spark-mllib" class="headerlink" title="spark.mllib"></a>spark.mllib</h3><p>Spark MLlib是Spark的重要组成部分，是最初提供的一个机器学习库。该库有一个缺点：如果数据集非常复杂，需要做多次处理，或者是对新数据需要结合多个已经训练好的单个模型进行综合计算时，使用Spark MLlib会使程序结构变得复杂，甚至难以理解和实现。</p>
<p>spark.mllib是基于RDD的原始算法API，目前处于维护状态。该库下包含4类常见的机器学习算法：<strong>分类</strong>、<strong>回归</strong>、<strong>聚类</strong>、<strong>协同过滤</strong>。指的注意的是，基于RDD的API不会再添加新的功能。</p>
<h3 id="spark-ml"><a href="#spark-ml" class="headerlink" title="spark.ml"></a>spark.ml</h3><p>Spark1.2版本引入了ML Pipeline，经过多个版本的发展，Spark ML克服了MLlib处理机器学习问题的一些不足(复杂、流程不清晰)，向用户提供了基于DataFrame API的机器学习库，使得构建整个机器学习应用的过程变得简单高效。</p>
<p><code>Spark ML</code>不是正式名称，用于指代基于DataFrame API的MLlib库 。与RDD相比，DataFrame提供了更加友好的API。DataFrame的许多好处包括Spark数据源，SQL / DataFrame查询，Tungsten和Catalyst优化以及跨语言的统一API。</p>
<p>Spark ML API提供了很多数据特征处理函数，如特征选取、特征转换、类别数值化、正则化、降维等。另外基于DataFrame API的ml库支持构建机器学习的Pipeline，把机器学习过程一些任务有序地组织在一起，便于运行和迁移。Spark官方推荐使用spark.ml库。</p>
<h3 id="数据变换"><a href="#数据变换" class="headerlink" title="数据变换"></a>数据变换</h3><p>数据变换是数据预处理的一项重要工作，比如对数据进行规范化、离散化、衍生指标等等。Spark ML中提供了非常丰富的数据转换算法，详细可以参考官网，现归纳如下：</p>
<p><img src="//jiamaoxiang.top/2020/07/31/第六篇-Spark-MLLib机器学习/%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E7%AE%97%E6%B3%95.png" alt></p>
<p>上面的转换算法中，词频逆文档频率(TF-IDF)、Word2Vec、PCA是比较常见的，如果你做过文本挖掘处理，那么对此应该并不陌生。</p>
<h3 id="数据规约"><a href="#数据规约" class="headerlink" title="数据规约"></a>数据规约</h3><p>大数据是机器学习的基础，为机器学习提供充足的数据训练集。在数据量非常大的时候，需要通过数据规约技术删除或者减少冗余的维度属性以来达到精简数据集的目的，类似于抽样的思想，虽然缩小了数据容量，但是并没有改变数据的完整性。Spark ML提供的特征选择和降维的方法如下表所示：</p>
<p><img src="//jiamaoxiang.top/2020/07/31/第六篇-Spark-MLLib机器学习/%E6%95%B0%E6%8D%AE%E8%A7%84%E7%BA%A6.png" alt></p>
<p>选择特征和降维是机器学习中常用的手段，可以使用上述的方法减少特征的选择，消除噪声的同时还能够维持原始的数据结构特征。尤其是主成分分析法(PCA)，无论是在统计学领域还是机器学习领域，都起到了很重要的作用。                                                        </p>
<h3 id="机器学习算法"><a href="#机器学习算法" class="headerlink" title="机器学习算法"></a>机器学习算法</h3><p>Spark支持分类、回归、聚类、推荐等常用的机器学习算法。见下表：</p>
<p><img src="//jiamaoxiang.top/2020/07/31/第六篇-Spark-MLLib机器学习/%E7%AE%97%E6%B3%95.png" alt></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文对机器学习进行了总体介绍，主要包括机器学习的基本概念、机器学习的基本分类、Spark机器学习库的介绍。通过本文或许已经对机器学习有了初步的了解，在下一篇，我将会分享基于Spark ML库构建一个机器学习的应用,主要涉及LDA主题模型以及K-means聚类。</p>
<blockquote>
<p>公众号『大数据技术与数仓』，回复『资料』领取大数据资料包</p>
</blockquote>
</div><div class="recommended_posts"><h3>相关推荐 ☟</h3><li><a href="https://jiamaoxiang.top/2020/08/06/数仓面试-四个在工作后才知道的SQL密技/" target="_blank">数仓面试|四个在工作后才知道的SQL密技</a></li><li><a href="https://jiamaoxiang.top/2020/08/02/第七篇-Spark平台下基于LDA的k-means算法实现/" target="_blank">第七篇|Spark平台下基于LDA的k-means算法实现</a></li><li><a href="https://jiamaoxiang.top/2020/07/29/第五篇-Spark-Streaming编程指南-2/" target="_blank">第五篇|Spark-Streaming编程指南(2)</a></li><li><a href="https://jiamaoxiang.top/2020/07/27/第四篇-Spark-Streaming编程指南/" target="_blank">第四篇|Spark Streaming编程指南(1)</a></li></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Jia MaoXiang</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2020/07/31/第六篇-Spark-MLLib机器学习/">https://jiamaoxiang.top/2020/07/31/第六篇-Spark-MLLib机器学习/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本文为博主原创文章，遵循CC BY-SA 4.0版权协议，转载请附上原文出处链接和本声明</li></ul></div><br><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://jiamaoxiang.top/2020/07/31/第六篇-Spark-MLLib机器学习/" data-id="ckipouvgq0050cg7qse87s3lq" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACtUlEQVR42u3aQXLCMAwFUO5/aTrTFYsm/ZIsYPG8YkIKfu5MbL70eMTj+TvuryevX6+8jqt3r64cHnh4eHitqV+N+y9I7kyoySJefcv9YuHh4eHt8ZKH/v3Uk4d+/gxPeNEGhoeHh/dRXjKV+wd3b0vo3Y+Hh4f3bbz8EHxginh4eHhfyUvCiPuP7gW1eQiynrXg4eHhxbxqAewbXi/W9/Dw8PAGVfVelNA7+OZXCrPFw8PDW+BVi1v3hbF5gLtRPMPDw8Pb4yV/kHxxQup9Wn68/mNjwMPDwzvEy9tMo3UKPqfaalBdyj9+MeDh4eGt8aqH5mpwUN0Mevdfbgx4eHh4R3l5IDuPLXpxRrUsV96j8PDw8Iq86pX83fn9yWZz+S4eHh7eAi8vWVWpedtrcoCulsTw8PDwPstLAtY8nK0eiyeNCHh4eHh7vMnROQecCh2aB3Q8PDy8Q7xqw1Pv/l55LI9FLjcqPDw8vDVetcCfH6zzcKFKiv4NeHh4eGu8vJkgiWJ75/o8Ai7MEA8PD2+B1/v6ZCHyB/0zHr1Z4eHh4W3zeuWuckwQHI7zd/9ZCDw8PLyjvB6g2mTQCyCqB/copcDDw8M7xMsB1aXJQ4p86oWmKzw8PLxl3jyAyBsO8oihGkaUOyPw8PDwirxqwLp3/9kTMh4eHt4er1ee70W9veu9rQIPDw/v/by87DRpCMiP8tVlxcPDw9vjTULVSYzba0SoLgceHh7eBu9ZHHnokG8nyZVmywIeHh7eAm/SvzRpLKgemvMY99EbeHh4eEXeZDNIYoVJ4NtbVjw8PLz38E51IuSbQe/IPtrT8PDw8N7O6zUWTBoFeiUxPDw8vO/kJVMZTWu8qeDh4eFt86phRN4uUN0keoWxy8/Ew8PDW+D1ftEn+EnhP48zHvOBh4eHl/J+AOOSfYKVG4cUAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/Spark/">Spark</a></div><div class="post-nav"><a class="pre" href="/2020/08/02/第七篇-Spark平台下基于LDA的k-means算法实现/">第七篇|Spark平台下基于LDA的k-means算法实现</a><a class="next" href="/2020/07/29/第五篇-Spark-Streaming编程指南-2/">第五篇|Spark-Streaming编程指南(2)</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar-toc"><div class="stoc-article" id="sidebar-stoc"><strong class="stoc-title"><i class="fa fa-list-ul"> 目录</i></strong><div class="toc-nav" id="stoc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么是机器学习"><span class="toc-number">1.</span> <span class="toc-text">什么是机器学习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#大数据与机器学习"><span class="toc-number">2.</span> <span class="toc-text">大数据与机器学习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#机器学习分类"><span class="toc-number">3.</span> <span class="toc-text">机器学习分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spark-MLLib介绍"><span class="toc-number">4.</span> <span class="toc-text">Spark MLLib介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#spark-mllib"><span class="toc-number">4.1.</span> <span class="toc-text">spark.mllib</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spark-ml"><span class="toc-number">4.2.</span> <span class="toc-text">spark.ml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据变换"><span class="toc-number">4.3.</span> <span class="toc-text">数据变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据规约"><span class="toc-number">4.4.</span> <span class="toc-text">数据规约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#机器学习算法"><span class="toc-number">4.5.</span> <span class="toc-text">机器学习算法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li></ol></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 - 2020 <a href="/." rel="nofollow">Jmx's Blog.</a>All rights reserved.<br>Thoughts on technology, life and everything else.</div></div></div><script type="text/javascript" src="/js/toc.js?v=0.0.0"></script><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="100,99,98" opacity="0.5" zindex="0.7" count="150" src="//lib.baomitu.com/canvas-nest.js/2.0.4/canvas-nest.umd.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>