<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录朴实无华且枯燥的生活"><title>如何使用Hive进行OLAP分析 | Jmx's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '912b6cfc43243cd27aeb428f7dbf7823';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="/js/toc.js?v=0.0.0"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">如何使用Hive进行OLAP分析</h1><a id="logo" href="/.">Jmx's Blog</a><p class="description">Keep it Simple and Stupid!</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-pied-piper-alt"> 关于</i></a><a href="/tags"><i class="fa fa-tags"> 标签</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">如何使用Hive进行OLAP分析</h1><div class="post-meta">Apr 9, 2020<span> | </span><span class="category"><a href="/categories/Hive/">Hive</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.2k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 8</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>本文首先介绍了什么是OLAP，接着介绍Hive中提供的几种OLAP分析的函数，并对每一种函数进行了详细说明，并给出了相关的图示解释，最后以一个案例说明了这几种函数的使用方式，可以进一步加深理解。</p>
<a id="more"></a>

<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>在线分析处理(OLAP,Online Analytical Processing)是通过带层次的维度和跨维度进行多维分析的，简单理解为一种多维数据分析的方式，通过OLAP可以展示数据仓库中数据的多维逻辑视图。在多维分析中，数据是按照维度(观察数据的角度)来表示的，比如商品、城市、客户。而维通常按层次(层次维度)组织的，如城市、省、国家，再比如时间也是有层次的，如天、周、月、季度和年。不同的管理者可以从不同的维度(视角)去观察这些数据，这些在多个不同维度上对数据进行综合考察的手段就是通常所说的数据仓库多维查询，最常见的就如上卷(roll-up)和下钻(drill-down)了,所谓上卷，指的是选定特定的数据范围之后，对其进行汇总统计以获取更高层次的信息。所谓下钻，指的是选定特定的数据范围之后，需要进一步查看细节的数据。从另一种意义上说，钻取就是针对多维展现的数据，进一步探究其内部的组成和来源。值得注意的是，上卷和下钻要求维度具有层级结构，即数仓中所说的层次维度。</p>
<h2 id="如何实现数据的多维分析"><a href="#如何实现数据的多维分析" class="headerlink" title="如何实现数据的多维分析"></a>如何实现数据的多维分析</h2><p>Hive提供了多维数据分析的函数，如GROUPING SETS,GROUPING_ID,CUBE,ROLLUP,通过这些分析函数，可以轻而易举的实现多维数据分析。下面将会通过一个案例来了解这些函数的具体含义以及该如何使用这些函数。注意：在hive中使用这些函数之前，要确保开启了map端聚合，即set hive.map.aggr=true，否则会报如下错误：</p>
<p><img src="//jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/map%E7%AB%AF%E8%81%9A%E5%90%88.png" alt></p>
<h3 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h3><ul>
<li>GROUPING SETS</li>
</ul>
<p>在一个group by查询中，通过该子句可以对不同维度或同一维度的不同层次进行聚合，简单理解为一条sql可以实现多种不同的分组规则，用户可以在该函数中传入自己定义的多种分组字段，本质上等价于多个group by语句进行UNION，对于GROUPING SETS子句中的空白集’（）’表示对总体进行聚集。</p>
<p><strong>示例模板</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用GROUPING SETS查询</span></span><br><span class="line"><span class="keyword">SELECT</span> a,</span><br><span class="line">       b,</span><br><span class="line">       <span class="keyword">SUM</span>(c)</span><br><span class="line"><span class="keyword">FROM</span> tab1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> a,b</span><br><span class="line"><span class="keyword">GROUPING</span> <span class="keyword">SETS</span> ((a,b), a,b, ());</span><br><span class="line"><span class="comment">-- 与GROUP BY等价关系</span></span><br><span class="line"><span class="keyword">SELECT</span> a, b, <span class="keyword">SUM</span>( c ) <span class="keyword">FROM</span> tab1 <span class="keyword">GROUP</span> <span class="keyword">BY</span> a, b</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> a, <span class="literal">null</span>, <span class="keyword">SUM</span>( c ) <span class="keyword">FROM</span> tab1 <span class="keyword">GROUP</span> <span class="keyword">BY</span> a, <span class="literal">null</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="literal">null</span>, b, <span class="keyword">SUM</span>( c ) <span class="keyword">FROM</span> tab1 <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="literal">null</span>, b</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="literal">null</span>, <span class="literal">null</span>, <span class="keyword">SUM</span>( c ) <span class="keyword">FROM</span> tab1;</span><br></pre></td></tr></table></figure>

<ul>
<li>GROUPING__ID</li>
</ul>
<p>当使用聚合时，有时候会出现数据本身为null值，很难区分究竟是数据列本身为null值还是聚合数据行为null，即无法区分查询结果中的null值是属于列本身的还是聚合的结果行，因此需要一种方法识别出列中的null值。grouping_id 函数就是此场景下的解决方案。注意该函数是有两个下划线。这个函数为每种聚合数据行生成唯一的组id。它的返回值看起来像整型数值，其实是字符串类型，这个值使用了位图策略（bitvector，位向量），即它的二进制形式中的每一位表示对应列是否参与分组，如果某一列参与了分组，对应位就被置为1，否则为0。通过这种方式可以区分出数据本身中的null值。看到这是不是还是一头雾水，没关系，来看下面的示例：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 创建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_grouping__id(<span class="keyword">id</span> <span class="built_in">int</span>,amount <span class="built_in">decimal</span>(<span class="number">10</span>,<span class="number">2</span>));</span><br><span class="line"><span class="comment">-- 插入数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> test_grouping__id <span class="keyword">values</span>(<span class="number">1</span>,<span class="literal">null</span>),(<span class="number">1</span>,<span class="number">1</span>),(<span class="number">2</span>,<span class="number">2</span>),(<span class="number">3</span>,<span class="number">3</span>),(<span class="number">3</span>,<span class="literal">null</span>),(<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line"><span class="comment">--执行查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span>,</span><br><span class="line">       amount,</span><br><span class="line">       grouping__id,</span><br><span class="line">       <span class="keyword">count</span>(*) cnt</span><br><span class="line"><span class="keyword">FROM</span> test_grouping__id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">id</span>,</span><br><span class="line">         amount</span><br><span class="line"><span class="keyword">GROUPING</span> <span class="keyword">sets</span>(<span class="keyword">id</span>,(<span class="keyword">id</span>,amount),())</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> grouping__id</span><br></pre></td></tr></table></figure>

<p><strong>查询结果分析</strong></p>
<p>查询结果如下图所示：绿色框表示未进行分组，即进行全局聚合，grouping_id等于0，表示没有字段参与分组。蓝色框表示按照id进行分组，对应的grouping_id为1，表示只有一个字段参与了分组。橘色的框表示按照id和amount两个字段进行分组，grouping_id为3，即有两个字段参与了分组，转成十进制为2^0 + 2^1  = 3。</p>
<p><img src="//jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/grouping__id.png" alt></p>
<p>以上面为例，分组字段为id、amount，转成二进制表示形式为：</p>
<p><img src="//jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/%E4%BA%8C%E8%BF%9B%E5%88%B6.png" alt></p>
<ul>
<li>ROLLUP</li>
</ul>
<p>通用的语法为WITH ROLLUP,需要与group by一起用于在维的层次结构级别上计算聚合。功能为可以按照group by的分组字段进行组合，计算出不同分组的结果。注意对于分组字段的组合会与最左边的字段为主。使用ROLLUP的GROUP BY a，b，c假定层次结构是“ a”向下钻取到“ b”，“ b”向下钻取到“ c”。则可以通过GROUP BY a，b，c，WITH ROLLUP进行实现，该语句等价于GROUP BY a，b，c GROUPING SETS（（a，b，c），（a，b），（a），（））。即使用WITH ROLLUP，首先会对全局聚合(不分组)，然后会按GROUP BY字段组合，进行聚合，但是最左侧的分组字段必须参与分组，比如a字段是最左侧的字段，则a必定参与分组组合。</p>
<p><strong>示例模板</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用WITH ROLLUP查询</span></span><br><span class="line"><span class="keyword">SELECT</span> a,</span><br><span class="line">       b,</span><br><span class="line">       c</span><br><span class="line">       <span class="keyword">SUM</span>(d)</span><br><span class="line"><span class="keyword">FROM</span> tab1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> a,b,c</span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">ROLLUP</span></span><br><span class="line"><span class="comment">-- 等价于下面的方式</span></span><br><span class="line"><span class="keyword">SELECT</span> a,</span><br><span class="line">       b,</span><br><span class="line">       c,</span><br><span class="line">       <span class="keyword">SUM</span>(d)</span><br><span class="line"><span class="keyword">FROM</span> tab1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> a,b,c</span><br><span class="line"><span class="keyword">GROUPING</span> <span class="keyword">SETS</span> ((a,b,c), (a,b), (a),());</span><br></pre></td></tr></table></figure>

<ul>
<li>CUBE</li>
</ul>
<p>CUBE表示一个立方体，apache的kylin使用就是这种预计算方式。即会对给定的维度(分组字段)进行多种组合之后，形成不同分组规则的数据结果。一旦我们在一组维度上计算出CUBE，就可以得到这些维度上所有可能的聚合聚合结果。比如：<strong>GROUP BY a，b，c WITH CUBE</strong>，等价于<strong>GROUP BY a，b，c GROUPING SETS（（a，b，c），（a，b），（b，c）， （a，c），（a），（b），（c），（））</strong>。</p>
<p>其实，可以将上面的情况抽象成排列组合的问题，即从分组字段集合(假设有n个字段)中随意取出0~n个字段，那么会有多少中组合方式，如下面公式所示：</p>
<p><img src="//jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/%E7%BB%84%E5%90%881.png" alt></p>
<p>结合上面的例子，<strong>GROUP BY a，b，c WITH CUBE</strong>，那么所有的组合方式有：（a，b，c），（a，b），（b，c）， （a，c），（a），（b），（c），（）,一共有8种组合，即2^3 = 8。</p>
<p><strong>示例模板</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用WITH CUBE查询</span></span><br><span class="line"><span class="keyword">SELECT</span> a,</span><br><span class="line">       b,</span><br><span class="line">       c</span><br><span class="line">       <span class="keyword">SUM</span>(d)</span><br><span class="line"><span class="keyword">FROM</span> tab1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> a,b,c</span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CUBE</span></span><br><span class="line"><span class="comment">-- 等价于下面的方式</span></span><br><span class="line"><span class="keyword">SELECT</span> a,</span><br><span class="line">       b,</span><br><span class="line">       c,</span><br><span class="line">       <span class="keyword">SUM</span>(d)</span><br><span class="line"><span class="keyword">FROM</span> tab1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> a,b,c</span><br><span class="line"><span class="keyword">GROUPING</span> <span class="keyword">SETS</span> ((a,b,c),(a,b),(b,c), (a,c),(a),(b),(c),());</span><br></pre></td></tr></table></figure>

<h3 id="使用案例"><a href="#使用案例" class="headerlink" title="使用案例"></a>使用案例</h3><h4 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h4><p>有一份用户行为数据集，包括用户的所有行为（包括pv点击、buy购买、cart加购、fav收藏），具体如下表所示：</p>
<table>
<thead>
<tr>
<th>字段名</th>
<th align="left">列名称</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td>user_id</td>
<td align="left">用户ID</td>
<td align="left">整数类型，用户ID</td>
</tr>
<tr>
<td>item_id</td>
<td align="left">商品ID</td>
<td align="left">整数类型，商品ID</td>
</tr>
<tr>
<td>category_id</td>
<td align="left">商品类目ID</td>
<td align="left">整数类型，商品所属类目ID</td>
</tr>
<tr>
<td>behavior</td>
<td align="left">行为类型</td>
<td align="left">字符串，枚举类型，包括(‘pv’, ‘buy’, ‘cart’, ‘fav’)</td>
</tr>
<tr>
<td>access_time</td>
<td align="left">时间戳</td>
<td align="left">行为发生的时间戳，单位秒</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 创建表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user_behavior</span><br><span class="line">             (</span><br><span class="line">                user_id <span class="built_in">int</span> ,</span><br><span class="line">                item_id <span class="built_in">int</span>,</span><br><span class="line">                category_id <span class="built_in">int</span>,</span><br><span class="line">                behavior <span class="keyword">string</span>,</span><br><span class="line">               access_time <span class="keyword">string</span></span><br><span class="line">               )</span><br><span class="line"><span class="keyword">ROW</span> <span class="keyword">FORMAT</span> <span class="keyword">DELIMITED</span> <span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">','</span>;</span><br><span class="line"><span class="comment">-- 装载数据</span></span><br><span class="line">1,101,1,pv,1511658000</span><br><span class="line">2,102,1,pv,1511658000</span><br><span class="line">3,103,1,pv,1511658000</span><br><span class="line">4,104,2,cart,1511659329</span><br><span class="line">5,105,2,buy,1511659326</span><br><span class="line">6,106,3,fav,1511659323</span><br><span class="line">7,101,1,pv,1511658010</span><br><span class="line">8,102,1,buy,1511658200</span><br><span class="line">9,103,1,cart,1511658030</span><br><span class="line">10,107,3,fav,1511659332</span><br></pre></td></tr></table></figure>

<h4 id="GROUPING-SETS使用"><a href="#GROUPING-SETS使用" class="headerlink" title="GROUPING SETS使用"></a>GROUPING SETS使用</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 查询每种商品品类、每种用户行为的访问次数</span></span><br><span class="line"><span class="comment">-- 查询每种用户行为的访问次数</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">item_id,</span><br><span class="line">category_id,</span><br><span class="line">behavior,</span><br><span class="line"><span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> cnt,</span><br><span class="line">GROUPING__ID </span><br><span class="line"><span class="keyword">FROM</span> user_behavior </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> item_id,category_id,behavior </span><br><span class="line"><span class="keyword">GROUPING</span> <span class="keyword">SETS</span> ((category_id,behavior),behavior)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> GROUPING__ID;</span><br></pre></td></tr></table></figure>

<p><strong>结果如下：</strong></p>
<p><img src="//jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/grouping_set.png" alt></p>
<h4 id="ROLLUP使用"><a href="#ROLLUP使用" class="headerlink" title="ROLLUP使用"></a>ROLLUP使用</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 查询每种商品品类的访问次数</span></span><br><span class="line"><span class="comment">-- 查询每种商品品类、每种用户行为的次数</span></span><br><span class="line"><span class="comment">-- 查询用户的总访问次数</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">category_id,</span><br><span class="line">behavior,</span><br><span class="line"><span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> cnt,</span><br><span class="line">GROUPING__ID </span><br><span class="line"><span class="keyword">FROM</span> user_behavior </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> category_id,behavior </span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">ROLLUP</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> GROUPING__ID;</span><br></pre></td></tr></table></figure>

<p><strong>结果如下：</strong></p>
<p><img src="//jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/rollup.png" alt></p>
<h4 id="CUBE使用"><a href="#CUBE使用" class="headerlink" title="CUBE使用"></a>CUBE使用</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 查询每种商品品类的访问次数</span></span><br><span class="line"><span class="comment">-- 查询每种用户行为的次数</span></span><br><span class="line"><span class="comment">-- 查询每种商品品类、每种用户行为的次数</span></span><br><span class="line"><span class="comment">-- 查询用户的总访问次数</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">category_id,</span><br><span class="line">behavior,</span><br><span class="line"><span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> cnt,</span><br><span class="line">GROUPING__ID </span><br><span class="line"><span class="keyword">FROM</span> user_behavior </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> category_id,behavior </span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CUBE</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> GROUPING__ID;</span><br></pre></td></tr></table></figure>

<p><strong>结果如下：</strong></p>
<p><img src="//jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/cube.png" alt></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文首先介绍了什么是OLAP，接着介绍Hive中提供的几种OLAP分析的函数，并对每一种函数进行了详细说明，并给出了相关的图示解释，最后以一个案例说明了这几种函数的使用方式，可以进一步加深理解。</p>
</div><div class="recommended_posts"><h3>相关推荐 ☟</h3><li><a href="https://jiamaoxiang.top/2020/04/17/Flink基于时间与窗口的算子/" target="_blank">Flink的时间与watermarks详解</a></li><li><a href="https://jiamaoxiang.top/2020/04/12/Flink-DataStream-API编程指南/" target="_blank">Flink DataStream API编程指南</a></li><li><a href="https://jiamaoxiang.top/2020/04/02/你真的了解Flink-Kafka-connector吗？/" target="_blank">你真的了解Flink Kafka source吗？</a></li><li><a href="https://jiamaoxiang.top/2020/03/31/Flink1-10集成Hive快速入门/" target="_blank">Flink1.10集成Hive快速入门</a></li></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Jia MaoXiang</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2020/04/09/如何使用Hive进行OLAP分析/">https://jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本文为博主原创文章，遵循CC BY-SA 4.0版权协议，转载请附上原文出处链接和本声明</li></ul></div><br><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://jiamaoxiang.top/2020/04/09/如何使用Hive进行OLAP分析/" data-id="cka3lyv6z001tzg7q54a6v9a8" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACqUlEQVR42u3aQXIjIRAEQP//094HOAZV0aCdQ85JYUuIxBHQLvrnJ35+/zx/f/v0qfUIyWfX7zzw4OHh4Y2n/jSJ9Re0mPa71p99nCEeHh7eNV4y3VOHyhrTvv5gwcPDw3sZb1IoJ9v6vBDHw8PDewNvvbknR0heoP+HgwEPDw8v5iWFbzLpfAnyBcpHw8PDw/sOLw8U3vP6yv0eHh4e3vhWfS94zcOLNtqoZ4uHh4d3gdeWy3nB3RbTF2MOPDw8vKO8ybTagnv9k7zpKh8BDw8P7wbvVJPTXsi7B04WYpSj4OHh4S2/vd30k8Njr22rjSqigwcPDw/vAu/UpVceNOy1Xk0WBQ8PD+8sb9LMdA/WXrxF93t4eHh4R3l5wfrNJq29RXlMqfHw8PAO8fYanvbK4uRoORUl4+Hh4d3jzTffedzQLm4R5uLh4eFd4CVDtMHBXmyRh7l5SwEeHh7ePd6kOM438VOwpE2hqOvx8PDwBrxvhrAHNvpJ0xUeHh7egLe3KbeTTsrrPAQpIl08PDy8y7w8hJ1s3Hv4zTYvPDw8vMu8ycEwbxSYHBKP4+Ph4eFd4yVf2Ya2yZLNQ5APcTAeHh7eNd5eOds2RbWxRfJnKHrK8PDw8A7x5lfy6/e3mFPxLh4eHt43eW0IuxfpTsDJmFE3GR4eHt6Yl7D3Gq3aBq+2aP5whODh4eFd4+WBQlv+FldWSTjbBsR4eHh4R3m/5XOqCaAdebO8xsPDw7vAy59TzQT5OJPXeHh4eLd5+bTaZqlJZduGDgfCCDw8PLyS115Z5fHr3vXYgZQFDw8P7zW8/GqqPRj2oocozMXDw8N7AS8psudhaxJ2jJqu8PDw8Aa8tnVgUjrnocP82gwPDw/vBq/9hz8ZKFmgZFGKuHby4OHh4aW8f/ZH2k9Dgd4UAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/Hive/">Hive</a></div><div class="post-nav"><a class="pre" href="/2020/04/12/Flink-DataStream-API编程指南/">Flink DataStream API编程指南</a><a class="next" href="/2020/04/02/你真的了解Flink-Kafka-connector吗？/">你真的了解Flink Kafka source吗？</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar-toc"><div class="stoc-article" id="sidebar-stoc"><strong class="stoc-title"><i class="fa fa-list-ul"> 目录</i></strong><div class="toc-nav" id="stoc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#写在前面"><span class="toc-number">1.</span> <span class="toc-text">写在前面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何实现数据的多维分析"><span class="toc-number">2.</span> <span class="toc-text">如何实现数据的多维分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#简单介绍"><span class="toc-number">2.1.</span> <span class="toc-text">简单介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用案例"><span class="toc-number">2.2.</span> <span class="toc-text">使用案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#数据准备"><span class="toc-number">2.2.1.</span> <span class="toc-text">数据准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GROUPING-SETS使用"><span class="toc-number">2.2.2.</span> <span class="toc-text">GROUPING SETS使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ROLLUP使用"><span class="toc-number">2.2.3.</span> <span class="toc-text">ROLLUP使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CUBE使用"><span class="toc-number">2.2.4.</span> <span class="toc-text">CUBE使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">3.</span> <span class="toc-text">总结</span></a></li></ol></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 - 2020 <a href="/." rel="nofollow">Jmx's Blog.</a>All rights reserved.<br>Thoughts on technology, life and everything else.</div></div></div><script type="text/javascript" src="/js/toc.js?v=0.0.0"></script><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="100,99,98" opacity="0.5" zindex="0.7" count="150" src="//lib.baomitu.com/canvas-nest.js/2.0.4/canvas-nest.umd.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>