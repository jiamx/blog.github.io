<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录朴实无华且枯燥的生活"><title>Hive的条件函数与日期函数全面汇总解析 | Jmx's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '912b6cfc43243cd27aeb428f7dbf7823';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="/js/toc.js?v=0.0.0"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Hive的条件函数与日期函数全面汇总解析</h1><a id="logo" href="/.">Jmx's Blog</a><p class="description">Keep it Simple and Stupid!</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-pied-piper-alt"> 关于</i></a><a href="/tags"><i class="fa fa-tags"> 标签</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Hive的条件函数与日期函数全面汇总解析</h1><div class="post-meta">May 20, 2020<span> | </span><span class="category"><a href="/categories/Hive/">Hive</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.7k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 11</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>在<a href="https://mp.weixin.qq.com/s/K2TA_PhNzGEkucYxBXqhLw" target="_blank" rel="noopener">Hive的开窗函数实战</a>的文章中，主要介绍了Hive的分析函数的基本使用。本文是这篇文章的延续，涵盖了Hive所有的条件函数和日期函数，对于每个函数，本文都给出了具体的解释和使用案例，方便在工作中查阅。</p>
<a id="more"></a>

<h2 id="条件函数"><a href="#条件函数" class="headerlink" title="条件函数"></a>条件函数</h2><h3 id="assert-true-BOOLEAN-condition"><a href="#assert-true-BOOLEAN-condition" class="headerlink" title="assert_true(BOOLEAN condition)"></a>assert_true(BOOLEAN condition)</h3><ul>
<li>解释</li>
</ul>
<p>如果condition不为true，则抛出异常，否则返回null</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> assert_true(<span class="number">1</span>&lt;<span class="number">2</span>) <span class="comment">-- 返回null</span></span><br><span class="line"><span class="keyword">select</span> assert_true(<span class="number">1</span>&gt;<span class="number">2</span>) <span class="comment">-- 抛出异常</span></span><br></pre></td></tr></table></figure>

<h3 id="coalesce-T-v1-T-v2-…"><a href="#coalesce-T-v1-T-v2-…" class="headerlink" title="coalesce(T v1, T v2, …)"></a>coalesce(T v1, T v2, …)</h3><ul>
<li>解释</li>
</ul>
<p>返回第一个不为null的值，如果都为null，则返回null</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">coalesce</span>(<span class="literal">null</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="literal">null</span>)  <span class="comment">-- 返回1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">coalesce</span>(<span class="number">1</span>,<span class="literal">null</span>) <span class="comment">-- 返回1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">coalesce</span>(<span class="literal">null</span>,<span class="literal">null</span>) <span class="comment">-- 返回null</span></span><br></pre></td></tr></table></figure>

<h3 id="if-BOOLEAN-testCondition-T-valueTrue-T-valueFalseOrNull"><a href="#if-BOOLEAN-testCondition-T-valueTrue-T-valueFalseOrNull" class="headerlink" title="if(BOOLEAN testCondition, T valueTrue, T valueFalseOrNull)"></a>if(BOOLEAN testCondition, T valueTrue, T valueFalseOrNull)</h3><ul>
<li>解释</li>
</ul>
<p>如果testCondition条件为true，则返回第一个值，否则返回第二个值</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">if</span>(<span class="number">1</span> <span class="keyword">is</span> <span class="literal">null</span>,<span class="number">0</span>,<span class="number">1</span>)  <span class="comment">-- 返回1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">if</span>(<span class="literal">null</span> <span class="keyword">is</span> <span class="literal">null</span>,<span class="number">0</span>,<span class="number">1</span>) <span class="comment">-- 返回0</span></span><br></pre></td></tr></table></figure>

<h3 id="isnotnull-a"><a href="#isnotnull-a" class="headerlink" title="isnotnull(a)"></a>isnotnull(a)</h3><ul>
<li>解释</li>
</ul>
<p>如果参数a不为null，则返回true，否则返回false</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> isnotnull(<span class="number">1</span>) <span class="comment">-- 返回true</span></span><br><span class="line"><span class="keyword">select</span> isnotnull(<span class="literal">null</span>) <span class="comment">-- 返回false</span></span><br></pre></td></tr></table></figure>

<h3 id="isnull-a"><a href="#isnull-a" class="headerlink" title="isnull(a)"></a>isnull(a)</h3><ul>
<li>解释</li>
</ul>
<p>与isnotnull相反，如果参数a为null，则返回true，否则返回false</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">isnull</span>(<span class="literal">null</span>) <span class="comment">-- 返回true</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">isnull</span>(<span class="number">1</span>) <span class="comment">-- 返回false</span></span><br></pre></td></tr></table></figure>

<h3 id="nullif-a-b"><a href="#nullif-a-b" class="headerlink" title="nullif(a, b)"></a>nullif(a, b)</h3><ul>
<li>解释</li>
</ul>
<p>如果参数a=b，返回null，否则返回a值(Hive2.2.0版本)</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">nullif</span>(<span class="number">1</span>,<span class="number">2</span>) <span class="comment">-- 返回1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">nullif</span>(<span class="number">1</span>,<span class="number">1</span>) <span class="comment">-- 返回null</span></span><br></pre></td></tr></table></figure>

<h3 id="nvl-T-value-T-default-value"><a href="#nvl-T-value-T-default-value" class="headerlink" title="nvl(T value, T default_value)"></a>nvl(T value, T default_value)</h3><ul>
<li>解释</li>
</ul>
<p>如果value的值为null，则返回default_value默认值，否则返回value的值。在null值判断时，可以使用if函数给定默认值，也可以使用此函数给定默认值，使用该函数sql特别简洁。</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> nvl(<span class="number">1</span>,<span class="number">0</span>) <span class="comment">-- 返回1</span></span><br><span class="line"><span class="keyword">select</span> nvl(<span class="literal">null</span>,<span class="number">0</span>) <span class="comment">-- 返回0</span></span><br></pre></td></tr></table></figure>

<h2 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h2><h3 id="add-months-DATE-STRING-TIMESTAMP-start-date-INT-num-months"><a href="#add-months-DATE-STRING-TIMESTAMP-start-date-INT-num-months" class="headerlink" title="add_months(DATE|STRING|TIMESTAMP start_date, INT num_months)"></a>add_months(DATE|STRING|TIMESTAMP start_date, INT num_months)</h3><ul>
<li>解释</li>
</ul>
<p>start_date参数可以是string, date 或者timestamp类型，num_months参数时int类型。返回一个日期，该日期是在start_date基础之上加上num_months个月，即start_date之后null_months个月的一个日期。如果start_date的时间部分的数据会被忽略。注意：如果start_date所在月份的天数大于结果日期月的天数，则返回结果月的最后一天的日期。</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> add_months(<span class="string">"2020-05-20"</span>,<span class="number">2</span>); <span class="comment">-- 返回2020-07-20</span></span><br><span class="line"><span class="keyword">select</span> add_months(<span class="string">"2020-05-20"</span>,<span class="number">8</span>); <span class="comment">-- 返回2021-01-20</span></span><br><span class="line"><span class="keyword">select</span> add_months(<span class="string">"2020-05-31"</span>,<span class="number">1</span>); <span class="comment">-- 返回2020-06-30,5月有31天，6月只有30天，所以返回下一个月的最后一天</span></span><br></pre></td></tr></table></figure>

<h3 id="current-date"><a href="#current-date" class="headerlink" title="current_date"></a>current_date</h3><ul>
<li>解释</li>
</ul>
<p>返回查询时刻的当前日期</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">current_date</span>() <span class="comment">-- 返回当前查询日期2020-05-20</span></span><br></pre></td></tr></table></figure>

<h3 id="current-timestamp"><a href="#current-timestamp" class="headerlink" title="current_timestamp()"></a>current_timestamp()</h3><ul>
<li>解释</li>
</ul>
<p>返回查询时刻的当前时间</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">current_timestamp</span>() <span class="comment">-- 2020-05-20 14:40:47.273</span></span><br></pre></td></tr></table></figure>

<h3 id="datediff-STRING-enddate-STRING-startdate"><a href="#datediff-STRING-enddate-STRING-startdate" class="headerlink" title="datediff(STRING enddate, STRING startdate)"></a>datediff(STRING enddate, STRING startdate)</h3><ul>
<li>解释</li>
</ul>
<p>返回开始日期startdate与结束日期enddate之前相差的天数</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">datediff</span>(<span class="string">"2020-05-20"</span>,<span class="string">"2020-05-21"</span>); <span class="comment">-- 返回-1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">datediff</span>(<span class="string">"2020-05-21"</span>,<span class="string">"2020-05-20"</span>); <span class="comment">-- 返回1</span></span><br></pre></td></tr></table></figure>

<h3 id="date-add-DATE-startdate-INT-days"><a href="#date-add-DATE-startdate-INT-days" class="headerlink" title="date_add(DATE startdate, INT days)"></a>date_add(DATE startdate, INT days)</h3><ul>
<li>解释</li>
</ul>
<p>在startdate基础上加上几天，然后返回加上几天之后的一个日期</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(<span class="string">"2020-05-20"</span>,<span class="number">1</span>); <span class="comment">-- 返回2020-05-21,1表示加1天</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(<span class="string">"2020-05-20"</span>,<span class="number">-1</span>); <span class="comment">-- 返回2020-05-19，-1表示减一天</span></span><br></pre></td></tr></table></figure>

<h3 id="date-sub-DATE-startdate-INT-days"><a href="#date-sub-DATE-startdate-INT-days" class="headerlink" title="date_sub(DATE startdate, INT days)"></a>date_sub(DATE startdate, INT days)</h3><ul>
<li>解释</li>
</ul>
<p>在startdate基础上减去几天，然后返回减去几天之后的一个日期,功能与date_add很类似</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="string">"2020-05-20"</span>,<span class="number">1</span>); <span class="comment">-- 返回2020-05-19,1表示减1天</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="string">"2020-05-20"</span>,<span class="number">-1</span>); <span class="comment">-- 返回2020-05-21，-1表示加1天</span></span><br></pre></td></tr></table></figure>

<h3 id="date-format-DATE-TIMESTAMP-STRING-ts-STRING-fmt"><a href="#date-format-DATE-TIMESTAMP-STRING-ts-STRING-fmt" class="headerlink" title="date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)"></a>date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)</h3><ul>
<li>解释</li>
</ul>
<p>将date/timestamp/string类型的值转换为一个具体格式化的字符串。支持java的SimpleDateFormat格式，第二个参数fmt必须是一个常量</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">date_format</span>(<span class="string">'2020-05-20'</span>, <span class="string">'yyyy'</span>); <span class="comment">-- 返回2020</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_format</span>(<span class="string">'2020-05-20'</span>, <span class="string">'MM'</span>); <span class="comment">-- 返回05</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_format</span>(<span class="string">'2020-05-20'</span>, <span class="string">'dd'</span>); <span class="comment">-- 返回20</span></span><br><span class="line"><span class="comment">-- 返回2020年05月20日 00时00分00秒</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_format</span>(<span class="string">'2020-05-20'</span>, <span class="string">'yyyy年MM月dd日 HH时mm分ss秒'</span>) ;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_format</span>(<span class="string">'2020-05-20'</span>, <span class="string">'yy/MM/dd'</span>) <span class="comment">-- 返回 20/05/20</span></span><br></pre></td></tr></table></figure>

<h3 id="dayofmonth-STRING-date"><a href="#dayofmonth-STRING-date" class="headerlink" title="dayofmonth(STRING date)"></a>dayofmonth(STRING date)</h3><ul>
<li>解释</li>
</ul>
<p>返回一个日期或时间的天,与day()函数功能相同</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">dayofmonth</span>(<span class="string">'2020-05-20'</span>) <span class="comment">-- 返回20</span></span><br></pre></td></tr></table></figure>

<h3 id="extract-field-FROM-source"><a href="#extract-field-FROM-source" class="headerlink" title="extract(field FROM source)"></a>extract(field FROM source)</h3><ul>
<li>解释</li>
</ul>
<p>提取 day, dayofweek, hour, minute, month, quarter, second, week 或者year的值，field可以选择day, dayofweek, hour, minute, month, quarter, second, week 或者year，source必须是一个date、timestamp或者可以转为 date 、timestamp的字符串。注意：Hive 2.2.0版本之后支持该函数</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">year</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回2020，年</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">quarter</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回2，季度</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">month</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回05，月份</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">week</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回21，同weekofyear，一年中的第几周</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">dayofweek</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回4,代表星期三</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">day</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回20，天</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">hour</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回15，小时</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">minute</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回21，分钟</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">second</span> <span class="keyword">from</span> <span class="string">'2020-05-20 15:21:34.467'</span>); <span class="comment">-- 返回34，秒</span></span><br></pre></td></tr></table></figure>

<h3 id="year-STRING-date"><a href="#year-STRING-date" class="headerlink" title="year(STRING date)"></a>year(STRING date)</h3><ul>
<li>解释</li>
</ul>
<p>返回时间的年份,可以用extract函数替代</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">year</span>(<span class="string">'2020-05-20 15:21:34'</span>); <span class="comment">-- 返回2020</span></span><br></pre></td></tr></table></figure>

<h3 id="quarter-DATE-TIMESTAMP-STRING-a"><a href="#quarter-DATE-TIMESTAMP-STRING-a" class="headerlink" title="quarter(DATE|TIMESTAMP|STRING a)"></a>quarter(DATE|TIMESTAMP|STRING a)</h3><ul>
<li>解释</li>
</ul>
<p>返回给定时间或日期的季度，1至4个季度,可以用extract函数替代</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">quarter</span>(<span class="string">'2020-05-20 15:21:34'</span>); <span class="comment">-- 返回2，第2季度</span></span><br></pre></td></tr></table></figure>

<h3 id="month-STRING-date"><a href="#month-STRING-date" class="headerlink" title="month(STRING date)"></a>month(STRING date)</h3><ul>
<li>解释</li>
</ul>
<p>返回时间的月份,可以用extract函数替代</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">month</span>(<span class="string">'2020-05-20 15:21:34'</span>) <span class="comment">-- 返回5</span></span><br></pre></td></tr></table></figure>

<h3 id="day-STRING-date"><a href="#day-STRING-date" class="headerlink" title="day(STRING date),"></a>day(STRING date),</h3><ul>
<li>解释</li>
</ul>
<p>返回一个日期或者时间的天,可以用extract函数替代</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">day</span>(<span class="string">"2020-05-20"</span>); <span class="comment">-- 返回20</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">day</span>(<span class="string">"2020-05-20 15:05:27.5"</span>); <span class="comment">-- 返回20</span></span><br></pre></td></tr></table></figure>

<h3 id="hour-STRING-date"><a href="#hour-STRING-date" class="headerlink" title="hour(STRING date)"></a>hour(STRING date)</h3><ul>
<li>解释</li>
</ul>
<p>返回一个时间的小时,可以用extract函数替代</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">hour</span>(<span class="string">'2020-05-20 15:21:34'</span>);<span class="comment">-- 返回15</span></span><br></pre></td></tr></table></figure>

<h3 id="minute-STRING-date"><a href="#minute-STRING-date" class="headerlink" title="minute(STRING date)"></a>minute(STRING date)</h3><ul>
<li>解释</li>
</ul>
<p>返回一个时间的分钟值,可以用extract函数替代</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">minute</span>(<span class="string">'2020-05-20 15:21:34'</span>); <span class="comment">-- 返回21</span></span><br></pre></td></tr></table></figure>

<h3 id="second-STRING-date"><a href="#second-STRING-date" class="headerlink" title="second(STRING date)"></a>second(STRING date)</h3><ul>
<li>解释</li>
</ul>
<p>返回一个时间的秒,可以用extract函数替代</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">second</span>(<span class="string">'2020-05-20 15:21:34'</span>); <span class="comment">--返回34</span></span><br></pre></td></tr></table></figure>

<h3 id="from-unixtime-BIGINT-unixtime-STRING-format"><a href="#from-unixtime-BIGINT-unixtime-STRING-format" class="headerlink" title="from_unixtime(BIGINT unixtime [, STRING format])"></a>from_unixtime(BIGINT unixtime [, STRING format])</h3><ul>
<li>解释</li>
</ul>
<p>将将Unix时间戳转换为字符串格式的时间(比如yyyy-MM-dd HH:mm:ss格式)</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> from_unixtime(<span class="number">1589960708</span>); <span class="comment">-- 返回2020-05-20 15:45:08</span></span><br><span class="line"><span class="keyword">select</span> from_unixtime(<span class="number">1589960708</span>, <span class="string">'yyyy-MM-dd hh:mm:ss'</span>); <span class="comment">-- -- 返回2020-05-20 15:45:08</span></span><br><span class="line"><span class="keyword">select</span> from_unixtime(<span class="number">1589960708</span>, <span class="string">'yyyy-MM-dd'</span>); <span class="comment">-- 返回2020-05-20</span></span><br></pre></td></tr></table></figure>

<h3 id="from-utc-timestamp-T-a-STRING-timezone"><a href="#from-utc-timestamp-T-a-STRING-timezone" class="headerlink" title="from_utc_timestamp(T a, STRING timezone)"></a>from_utc_timestamp(T a, STRING timezone)</h3><ul>
<li>解释</li>
</ul>
<p>转换为特定时区的时间</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> from_utc_timestamp(<span class="string">'2020-05-20 15:21:34'</span>,<span class="string">'PST'</span>); <span class="comment">-- 返回2020-05-20 08:21:34.0</span></span><br><span class="line"><span class="keyword">select</span> from_utc_timestamp(<span class="string">'2020-05-20 15:21:34'</span>,<span class="string">'GMT'</span>); <span class="comment">-- 返回2020-05-20 15:21:34.0</span></span><br><span class="line"><span class="keyword">select</span> from_utc_timestamp(<span class="string">'2020-05-20 15:21:34'</span>,<span class="string">'UTC'</span>); <span class="comment">-- 返回2020-05-20 15:21:34.0</span></span><br><span class="line"><span class="keyword">select</span> from_utc_timestamp(<span class="string">'2020-05-20 15:21:34'</span>,<span class="string">'DST'</span>); <span class="comment">-- 返回2020-05-20 15:21:34.0</span></span><br><span class="line"><span class="keyword">select</span> from_utc_timestamp(<span class="string">'2020-05-20 15:21:34'</span>,<span class="string">'CST'</span>); <span class="comment">-- 返回2020-05-20 10:21:34.0</span></span><br></pre></td></tr></table></figure>

<h3 id="last-day-STRING-date"><a href="#last-day-STRING-date" class="headerlink" title="last_day(STRING date)"></a>last_day(STRING date)</h3><ul>
<li>解释</li>
</ul>
<p>返回给定时间或日期所在月的最后一天，参数可以是’yyyy-MM-dd HH:mm:ss’ 或者 ‘yyyy-MM-dd’类型，时间部分会被忽略</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">last_day</span>(<span class="string">'2020-05-20 15:21:34'</span>); <span class="comment">-- 返回2020-05-31</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">last_day</span>(<span class="string">'2020-05-20'</span>); <span class="comment">-- 返回2020-05-31</span></span><br></pre></td></tr></table></figure>

<h3 id="to-date-STRING-timestamp"><a href="#to-date-STRING-timestamp" class="headerlink" title="to_date(STRING timestamp)"></a>to_date(STRING timestamp)</h3><ul>
<li>解释</li>
</ul>
<p>返回一个字符串时间的日期部分，去掉时间部分，2.1.0之前版本返回的是string，2.1.0版本及之后返回的是date</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">to_date</span>(<span class="string">'2020-05-20 15:21:34'</span>); <span class="comment">-- 返回2020-05-20</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">to_date</span>(<span class="string">'2020-05-20'</span>); <span class="comment">-- 返回2020-05-20</span></span><br></pre></td></tr></table></figure>

<h3 id="to-utc-timestamp-T-a-STRING-timezone"><a href="#to-utc-timestamp-T-a-STRING-timezone" class="headerlink" title="to_utc_timestamp(T a, STRING timezone)"></a>to_utc_timestamp(T a, STRING timezone)</h3><ul>
<li>解释</li>
</ul>
<p>转换为世界标准时间UTC的时间戳,与from_utc_timestamp类似</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> to_utc_timestamp(<span class="string">'2020-05-20 15:21:34'</span>, <span class="string">'GMT'</span>); <span class="comment">-- 返回2020-05-20 15:21:34.0</span></span><br></pre></td></tr></table></figure>

<h3 id="trunc-STRING-date-STRING-format"><a href="#trunc-STRING-date-STRING-format" class="headerlink" title="trunc(STRING date, STRING format)"></a>trunc(STRING date, STRING format)</h3><ul>
<li>解释</li>
</ul>
<p>截断日期到指定的日期精度，仅支持月（MONTH/MON/MM）或者年（YEAR/YYYY/YY）</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> trunc(<span class="string">'2020-05-20'</span>, <span class="string">'YY'</span>);   <span class="comment">-- 返回2020-01-01，返回年的1月1日</span></span><br><span class="line"><span class="keyword">select</span> trunc(<span class="string">'2020-05-20'</span>, <span class="string">'MM'</span>);   <span class="comment">-- 返回2020-05-01，返回月的第一天</span></span><br><span class="line"><span class="keyword">select</span> trunc(<span class="string">'2020-05-20 15:21:34'</span>, <span class="string">'MM'</span>);   <span class="comment">-- 返回2020-05-01</span></span><br></pre></td></tr></table></figure>

<h3 id="unix-timestamp-STRING-date-STRING-pattern"><a href="#unix-timestamp-STRING-date-STRING-pattern" class="headerlink" title="unix_timestamp([STRING date [, STRING pattern]])"></a>unix_timestamp([STRING date [, STRING pattern]])</h3><ul>
<li>解释</li>
</ul>
<p>参数时可选的，当参数为空时，返回当前Unix是时间戳，精确到秒。可以指定一个具体的日期，转换为Unix时间戳格式</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 返回1589959294</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">unix_timestamp</span>(<span class="string">'2020-05-20 15:21:34'</span>,<span class="string">'yyyy-MM-dd hh:mm:ss'</span>);</span><br><span class="line"><span class="comment">-- 返回1589904000</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">unix_timestamp</span>(<span class="string">'2020-05-20'</span>,<span class="string">'yyyy-MM-dd'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="weekofyear-STRING-date"><a href="#weekofyear-STRING-date" class="headerlink" title="weekofyear(STRING date)"></a>weekofyear(STRING date)</h3><ul>
<li>解释</li>
</ul>
<p>返回一个日期或时间在一年中的第几周，可以用extract替代</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">weekofyear</span>(<span class="string">'2020-05-20 15:21:34'</span>); <span class="comment">-- 返回21，第21周</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">weekofyear</span>(<span class="string">'2020-05-20'</span>); <span class="comment">-- 返回21，第21周</span></span><br></pre></td></tr></table></figure>

<h3 id="next-day-STRING-start-date-STRING-day-of-week"><a href="#next-day-STRING-start-date-STRING-day-of-week" class="headerlink" title="next_day(STRING start_date, STRING day_of_week)"></a>next_day(STRING start_date, STRING day_of_week)</h3><ul>
<li>解释</li>
</ul>
<p>参数start_date可以是一个时间或日期，day_of_week表示星期几，比如Mo表示星期一，Tu表示星期二，Wed表示星期三，Thur表示星期四，Fri表示星期五，Sat表示星期六，Sun表示星期日。如果指定的星期几在该日期所在的周且在该日期之后，则返回当周的星期几日期，如果指定的星期几不在该日期所在的周，则返回下一个星期几对应的日期</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> next_day(<span class="string">'2020-05-20'</span>,<span class="string">'Mon'</span>);<span class="comment">-- 返回当前日期的下一个周一日期:2020-05-25</span></span><br><span class="line"><span class="keyword">select</span> next_day(<span class="string">'2020-05-20'</span>,<span class="string">'Tu'</span>);<span class="comment">-- 返回当前日期的下一个周二日期:2020-05-26</span></span><br><span class="line"><span class="keyword">select</span> next_day(<span class="string">'2020-05-20'</span>,<span class="string">'Wed'</span>);<span class="comment">-- 返回当前日期的下一个周三日期:2020-05-27</span></span><br><span class="line"><span class="comment">-- 2020-05-20为周三，指定的参数为周四，所以返回当周的周四就是2020-05-21</span></span><br><span class="line"><span class="keyword">select</span> next_day(<span class="string">'2020-05-20'</span>,<span class="string">'Th'</span>);</span><br><span class="line"><span class="keyword">select</span> next_day(<span class="string">'2020-05-20'</span>,<span class="string">'Fri'</span>);<span class="comment">-- 返回周五日期2020-05-22</span></span><br><span class="line"><span class="keyword">select</span> next_day(<span class="string">'2020-05-20'</span>,<span class="string">'Sat'</span>); <span class="comment">-- 返回周六日期2020-05-23</span></span><br><span class="line"><span class="keyword">select</span> next_day(<span class="string">'2020-05-20'</span>,<span class="string">'Sun'</span>); <span class="comment">-- 返回周六日期2020-05-24</span></span><br></pre></td></tr></table></figure>

<p>该函数比较重要：比如取当前日期所在的周一和周日，通过长用在按周进行汇总数据</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(next_day(<span class="string">'2020-05-20'</span>,<span class="string">'MO'</span>),<span class="number">-7</span>); <span class="comment">-- 返回当前日期的周一日期2020-05-18</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(next_day(<span class="string">'2020-05-20'</span>,<span class="string">'MO'</span>),<span class="number">-1</span>); <span class="comment">-- 返回当前日期的周日日期2020-05-24</span></span><br></pre></td></tr></table></figure>

<h3 id="months-between-DATE-TIMESTAMP-STRING-date1-DATE-TIMESTAMP-STRING-date2"><a href="#months-between-DATE-TIMESTAMP-STRING-date1-DATE-TIMESTAMP-STRING-date2" class="headerlink" title="months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)"></a>months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)</h3><ul>
<li>解释</li>
</ul>
<p>返回 date1 和 date2 的月份差。如果date1大于date2，返回正值，否则返回负值，如果是相减是整数月，则返回一个整数，否则会返回小数</p>
<ul>
<li>使用案例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> months_between(<span class="string">'2020-05-20'</span>,<span class="string">'2020-05-20'</span>); <span class="comment">-- 返回0</span></span><br><span class="line"><span class="keyword">select</span> months_between(<span class="string">'2020-05-20'</span>,<span class="string">'2020-06-20'</span>); <span class="comment">-- 返回-1</span></span><br><span class="line"><span class="comment">-- 相差的整数月</span></span><br><span class="line"><span class="keyword">select</span> months_between(<span class="string">'2020-06-30'</span>,<span class="string">'2020-05-31'</span>); <span class="comment">-- 返回1</span></span><br><span class="line"><span class="comment">-- 非整数月，一个月差一天</span></span><br><span class="line"><span class="keyword">select</span> months_between(<span class="string">'2020-06-29'</span>,<span class="string">'2020-05-31'</span>); <span class="comment">-- 返回0.93548387</span></span><br></pre></td></tr></table></figure>

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>本文主要介绍了Hive的条件函数和日期函数，并给出了每个函数的解释说明和使用案例，本文覆盖了所有Hive内置的条件函数和日期函数，可以作为一个函数字典，方便工作中使用。</p>
<blockquote>
<p>公众号『大数据技术与数仓』，回复『资料』领取大数据资料包</p>
</blockquote>
</div><div class="recommended_posts"><h3>相关推荐 ☟</h3><li><a href="https://jiamaoxiang.top/2020/05/25/Flink-Table-API-SQL编程指南/" target="_blank">Flink Table API &amp; SQL编程指南(1)</a></li><li><a href="https://jiamaoxiang.top/2020/05/21/一统江湖的数仓开发辅助神器-DBeaver/" target="_blank">一统江湖的数仓开发辅助神器--DBeaver</a></li><li><a href="https://jiamaoxiang.top/2020/05/18/Greenplum集群Master与Segment节点故障检测与恢复/" target="_blank">Greenplum集群Master与Segment节点故障检测与恢复</a></li><li><a href="https://jiamaoxiang.top/2020/05/09/Flink-DataSet-API编程指南/" target="_blank">Flink DataSet API编程指南</a></li></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Jia MaoXiang</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2020/05/20/Hive的条件函数与日期函数全面汇总解析/">https://jiamaoxiang.top/2020/05/20/Hive的条件函数与日期函数全面汇总解析/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本文为博主原创文章，遵循CC BY-SA 4.0版权协议，转载请附上原文出处链接和本声明</li></ul></div><br><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://jiamaoxiang.top/2020/05/20/Hive的条件函数与日期函数全面汇总解析/" data-id="ckjsax1gg00319k7qmhcspsda" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADOUlEQVR42u3ay27iQBAFUP7/p5ltpMjm3mpbgzvHqwhiU6dZFPV4veLr/eP6/frRK7/veh9c+aecP+HiCxsbG/sh7Pfp1QISxtGR5UezEhU2Njb2ruzzsJLU1eaIHJbHVhwxNjY2NnacWpKw8rInSWDY2NjY2CtJIm8MraSf/5DAsLGxsb+enZcH7cAgL2ZmT7u9l4aNjY399ex8Kvr9f98y38bGxsb+YvasfX/tE64qVIoYsLGxsTdir49s88b9SqmQr+wUIwdsbGzsLdj5aLZtFeWLOHcvBkWniI2Njf1Ydt7oz5s45weXDxXaeOpCCBsbG3sLdt42StLeehGyXnIUtRc2Njb2Fuy8bZSXJUlJk//PrHQpDggbGxv74eyV5JTgV1Zw8oKnbodhY2Njb8SeXW36mbWEZqVOEic2Njb2X2PPMLPf/+1dyb15hNjY2NjPZa+UAfl6TR5c3mDKiyhsbGzsvdkr7fsVap4+kwLm4kEvNjY29qPY7eJOMgBYHxLMxrp5nNjY2Nh7s9uf9Unyy1tXObI9xChjY2NjYz+KfVVjKC9p8lFuPlSu0zA2Njb2dux2RWa2FnlVMyhPrlH/DBsbG3sL9qu82sXH9jl5W6odYxzmbWxsbOyHs+9oys9aRefpLS9sPnw92NjY2Bux80WcO5Z1VhZ38jiHUxFsbGzsh7DXU8Xs3VkpsnK4h6kLGxsbewv2tWsxK6PZaEwbFz+HT8PGxsbeiN3+3M/LgHYB6KqRQ/slYWNjYz+d3Q4G2kIiKRjypJVH+OF1bGxs7I3Ys9LijlFu+25beEQZGxsbG/vh7JV1mXyBJi8kZsODfHiMjY2NvTc7TyptgZEHnQ8A8tbY4ZQbGxsbewt2mwZmxUk9iB01vKKkiI2Njb0Fe1ZgzNLVVbVAO5Y+HAxgY2Njb8GeJYCVEO9oG+VtrBqPjY2N/RB22+hvPyA/rNn3M4sZGxsbez923sRJAm3Hvfkz2ybUhwSGjY2N/SfZ7Wg2Hwy3MSwNhrGxsbGx44R0/uQ88cwG0sV8GxsbG/vh7FmB0ZYcyeHOnnljLw0bGxv769l5ApilnHa9Jj+a2V3Y2NjYG7H/Ac1c2YWYvUFLAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/Hive/">Hive</a></div><div class="post-nav"><a class="pre" href="/2020/05/21/一统江湖的数仓开发辅助神器-DBeaver/">一统江湖的数仓开发辅助神器--DBeaver</a><a class="next" href="/2020/05/18/Greenplum集群Master与Segment节点故障检测与恢复/">Greenplum集群Master与Segment节点故障检测与恢复</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar-toc"><div class="stoc-article" id="sidebar-stoc"><strong class="stoc-title"><i class="fa fa-list-ul"> 目录</i></strong><div class="toc-nav" id="stoc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#条件函数"><span class="toc-number">1.</span> <span class="toc-text">条件函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#assert-true-BOOLEAN-condition"><span class="toc-number">1.1.</span> <span class="toc-text">assert_true(BOOLEAN condition)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#coalesce-T-v1-T-v2-…"><span class="toc-number">1.2.</span> <span class="toc-text">coalesce(T v1, T v2, …)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#if-BOOLEAN-testCondition-T-valueTrue-T-valueFalseOrNull"><span class="toc-number">1.3.</span> <span class="toc-text">if(BOOLEAN testCondition, T valueTrue, T valueFalseOrNull)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isnotnull-a"><span class="toc-number">1.4.</span> <span class="toc-text">isnotnull(a)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isnull-a"><span class="toc-number">1.5.</span> <span class="toc-text">isnull(a)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nullif-a-b"><span class="toc-number">1.6.</span> <span class="toc-text">nullif(a, b)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nvl-T-value-T-default-value"><span class="toc-number">1.7.</span> <span class="toc-text">nvl(T value, T default_value)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#日期函数"><span class="toc-number">2.</span> <span class="toc-text">日期函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#add-months-DATE-STRING-TIMESTAMP-start-date-INT-num-months"><span class="toc-number">2.1.</span> <span class="toc-text">add_months(DATE|STRING|TIMESTAMP start_date, INT num_months)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#current-date"><span class="toc-number">2.2.</span> <span class="toc-text">current_date</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#current-timestamp"><span class="toc-number">2.3.</span> <span class="toc-text">current_timestamp()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#datediff-STRING-enddate-STRING-startdate"><span class="toc-number">2.4.</span> <span class="toc-text">datediff(STRING enddate, STRING startdate)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#date-add-DATE-startdate-INT-days"><span class="toc-number">2.5.</span> <span class="toc-text">date_add(DATE startdate, INT days)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#date-sub-DATE-startdate-INT-days"><span class="toc-number">2.6.</span> <span class="toc-text">date_sub(DATE startdate, INT days)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#date-format-DATE-TIMESTAMP-STRING-ts-STRING-fmt"><span class="toc-number">2.7.</span> <span class="toc-text">date_format(DATE|TIMESTAMP|STRING ts, STRING fmt)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dayofmonth-STRING-date"><span class="toc-number">2.8.</span> <span class="toc-text">dayofmonth(STRING date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#extract-field-FROM-source"><span class="toc-number">2.9.</span> <span class="toc-text">extract(field FROM source)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#year-STRING-date"><span class="toc-number">2.10.</span> <span class="toc-text">year(STRING date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#quarter-DATE-TIMESTAMP-STRING-a"><span class="toc-number">2.11.</span> <span class="toc-text">quarter(DATE|TIMESTAMP|STRING a)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#month-STRING-date"><span class="toc-number">2.12.</span> <span class="toc-text">month(STRING date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#day-STRING-date"><span class="toc-number">2.13.</span> <span class="toc-text">day(STRING date),</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hour-STRING-date"><span class="toc-number">2.14.</span> <span class="toc-text">hour(STRING date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#minute-STRING-date"><span class="toc-number">2.15.</span> <span class="toc-text">minute(STRING date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#second-STRING-date"><span class="toc-number">2.16.</span> <span class="toc-text">second(STRING date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#from-unixtime-BIGINT-unixtime-STRING-format"><span class="toc-number">2.17.</span> <span class="toc-text">from_unixtime(BIGINT unixtime [, STRING format])</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#from-utc-timestamp-T-a-STRING-timezone"><span class="toc-number">2.18.</span> <span class="toc-text">from_utc_timestamp(T a, STRING timezone)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#last-day-STRING-date"><span class="toc-number">2.19.</span> <span class="toc-text">last_day(STRING date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#to-date-STRING-timestamp"><span class="toc-number">2.20.</span> <span class="toc-text">to_date(STRING timestamp)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#to-utc-timestamp-T-a-STRING-timezone"><span class="toc-number">2.21.</span> <span class="toc-text">to_utc_timestamp(T a, STRING timezone)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trunc-STRING-date-STRING-format"><span class="toc-number">2.22.</span> <span class="toc-text">trunc(STRING date, STRING format)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unix-timestamp-STRING-date-STRING-pattern"><span class="toc-number">2.23.</span> <span class="toc-text">unix_timestamp([STRING date [, STRING pattern]])</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#weekofyear-STRING-date"><span class="toc-number">2.24.</span> <span class="toc-text">weekofyear(STRING date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#next-day-STRING-start-date-STRING-day-of-week"><span class="toc-number">2.25.</span> <span class="toc-text">next_day(STRING start_date, STRING day_of_week)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#months-between-DATE-TIMESTAMP-STRING-date1-DATE-TIMESTAMP-STRING-date2"><span class="toc-number">2.26.</span> <span class="toc-text">months_between(DATE|TIMESTAMP|STRING date1, DATE|TIMESTAMP|STRING date2)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结"><span class="toc-number">3.</span> <span class="toc-text">小结</span></a></li></ol></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 - 2021 <a href="/." rel="nofollow">Jmx's Blog.</a>All rights reserved.<br>Thoughts on technology, life and everything else.</div></div></div><script type="text/javascript" src="/js/toc.js?v=0.0.0"></script><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="100,99,98" opacity="0.5" zindex="0.7" count="150" src="//lib.baomitu.com/canvas-nest.js/2.0.4/canvas-nest.umd.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>