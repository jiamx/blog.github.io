<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录朴实无华且枯燥的生活"><title>经典Hive SQL面试题 | Jmx's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '912b6cfc43243cd27aeb428f7dbf7823';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="/js/toc.js?v=0.0.0"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">经典Hive SQL面试题</h1><a id="logo" href="/.">Jmx's Blog</a><p class="description">Keep it Simple and Stupid!</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-pied-piper-alt"> 关于</i></a><a href="/tags"><i class="fa fa-tags"> 标签</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">经典Hive SQL面试题</h1><div class="post-meta">Oct 15, 2019<span> | </span><span class="category"><a href="/categories/Hive/">Hive</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 5k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 27</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>HQL练习</p>
<a id="more"></a>
<h1 id="第一题："><a href="#第一题：" class="headerlink" title="第一题："></a>第一题：</h1><h2 id="1-需求"><a href="#1-需求" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">我们有如下的用户访问数据</span><br><span class="line">	userId  visitDate   visitCount</span><br><span class="line">	u01 2017/1/21   5</span><br><span class="line">	u02 2017/1/23   6</span><br><span class="line">	u03 2017/1/22   8</span><br><span class="line">	u04 2017/1/20   3</span><br><span class="line">	u01 2017/1/23   6</span><br><span class="line">	u01 2017/2/21   8</span><br><span class="line">	U02 2017/1/23   6</span><br><span class="line">	U01 2017/2/22   4</span><br><span class="line">要求使用SQL统计出每个用户的累积访问次数，如下表所示：</span><br><span class="line">	用户id    月份  小计  累积</span><br><span class="line">	u01 2017-01 11  11</span><br><span class="line">	u01 2017-02 12  23</span><br><span class="line">	u02 2017-01 12  12</span><br><span class="line">	u03 2017-01 8   8</span><br><span class="line">	u04 2017-01 3   3</span><br></pre></td></tr></table></figure></code></pre><h2 id="2-实现"><a href="#2-实现" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备"><a href="#2-1数据准备" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test_sql.test1 ( 
    userId string, 
    visitDate string,
    visitCount INT )
ROW format delimited FIELDS TERMINATED BY &quot;\t&quot;;
INSERT INTO TABLE test_sql.test1
VALUES
    ( &apos;u01&apos;, &apos;2017/1/21&apos;, 5 ),
    ( &apos;u02&apos;, &apos;2017/1/23&apos;, 6 ),
    ( &apos;u03&apos;, &apos;2017/1/22&apos;, 8 ),
    ( &apos;u04&apos;, &apos;2017/1/20&apos;, 3 ),
    ( &apos;u01&apos;, &apos;2017/1/23&apos;, 6 ),
    ( &apos;u01&apos;, &apos;2017/2/21&apos;, 8 ),
    ( &apos;u02&apos;, &apos;2017/1/23&apos;, 6 ),
    ( &apos;u01&apos;, &apos;2017/2/22&apos;, 4 );</code></pre><h3 id="2-2查询SQL"><a href="#2-2查询SQL" class="headerlink" title="2.2查询SQL"></a>2.2查询SQL</h3><pre><code>SELECT t2.userid,
       t2.visitmonth,
       subtotal_visit_cnt,
       sum(subtotal_visit_cnt) over (partition BY userid
                                     ORDER BY visitmonth) AS total_visit_cnt
FROM
  (SELECT userid,
          visitmonth,
          sum(visitcount) AS subtotal_visit_cnt
   FROM
     (SELECT userid,
             date_format(regexp_replace(visitdate,&apos;/&apos;,&apos;-&apos;),&apos;yyyy-MM&apos;) AS visitmonth,
             visitcount
      FROM test_sql.test1) t1
   GROUP BY userid,
            visitmonth)t2
ORDER BY t2.userid,
         t2.visitmonth</code></pre><h1 id="第二题："><a href="#第二题：" class="headerlink" title="第二题："></a>第二题：</h1><h2 id="1-需求-1"><a href="#1-需求-1" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>有50W个京东店铺，每个顾客访客访问任何一个店铺的任何一个商品时都会产生一条访问日志，
访问日志存储的表名为Visit，访客的用户id为user_id，被访问的店铺名称为shop，数据如下：

                u1    a
                u2    b
                u1    b
                u1    a
                u3    c
                u4    b
                u1    a
                u2    c
                u5    b
                u4    b
                u6    c
                u2    c
                u1    b
                u2    a
                u2    a
                u3    a
                u5    a
                u5    a
                u5    a
请统计：
(1)每个店铺的UV（访客数）
(2)每个店铺访问次数top3的访客信息。输出店铺名称、访客id、访问次数</code></pre><h2 id="2-实现-1"><a href="#2-实现-1" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备-1"><a href="#2-1数据准备-1" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test_sql.test2 ( 
             user_id string, 
             shop string )
ROW format delimited FIELDS TERMINATED BY &apos;\t&apos;;    
INSERT INTO TABLE test_sql.test2 VALUES
( &apos;u1&apos;, &apos;a&apos; ),
( &apos;u2&apos;, &apos;b&apos; ),
( &apos;u1&apos;, &apos;b&apos; ),
( &apos;u1&apos;, &apos;a&apos; ),
( &apos;u3&apos;, &apos;c&apos; ),
( &apos;u4&apos;, &apos;b&apos; ),
( &apos;u1&apos;, &apos;a&apos; ),
( &apos;u2&apos;, &apos;c&apos; ),
( &apos;u5&apos;, &apos;b&apos; ),
( &apos;u4&apos;, &apos;b&apos; ),
( &apos;u6&apos;, &apos;c&apos; ),
( &apos;u2&apos;, &apos;c&apos; ),
( &apos;u1&apos;, &apos;b&apos; ),
( &apos;u2&apos;, &apos;a&apos; ),
( &apos;u2&apos;, &apos;a&apos; ),
( &apos;u3&apos;, &apos;a&apos; ),
( &apos;u5&apos;, &apos;a&apos; ),
( &apos;u5&apos;, &apos;a&apos; ),
( &apos;u5&apos;, &apos;a&apos; );</code></pre><h3 id="2-2查询SQL实现"><a href="#2-2查询SQL实现" class="headerlink" title="2.2查询SQL实现"></a>2.2查询SQL实现</h3><pre><code>(1)方式1：
            SELECT shop,
                   count(DISTINCT user_id)
            FROM test_sql.test2
            GROUP BY shop
   方式2：
            SELECT t.shop,
                   count(*)
            FROM
              (SELECT user_id,
                      shop
               FROM test_sql.test2
               GROUP BY user_id,
                        shop) t
            GROUP BY t.shop
(2)    
    SELECT t2.shop,
           t2.user_id,
           t2.cnt
    FROM
      (SELECT t1.*,
              row_number() over(partition BY t1.shop
                                ORDER BY t1.cnt DESC) rank
       FROM
         (SELECT user_id,
                 shop,
                 count(*) AS cnt
          FROM test_sql.test2
          GROUP BY user_id,
                   shop) t1)t2
    WHERE rank &lt;= 3        </code></pre><h1 id="第三题"><a href="#第三题" class="headerlink" title="第三题"></a>第三题</h1><h2 id="1-需求-2"><a href="#1-需求-2" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>已知一个表STG.ORDER，有如下字段:Date，Order_id，User_id，amount。
数据样例:2017-01-01,10029028,1000003251,33.57。
请给出sql进行统计:
(1)给出 2017年每个月的订单数、用户数、总成交金额。
(2)给出2017年11月的新客数(指在11月才有第一笔订单)</code></pre><h2 id="2-实现-2"><a href="#2-实现-2" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备-2"><a href="#2-1数据准备-2" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test_sql.test3 ( 
            dt string,
            order_id string, 
            user_id string, 
            amount DECIMAL ( 10, 2 ) )
ROW format delimited FIELDS TERMINATED BY &apos;\t&apos;;
INSERT INTO TABLE test_sql.test3 VALUES (&apos;2017-01-01&apos;,&apos;10029028&apos;,&apos;1000003251&apos;,33.57);
INSERT INTO TABLE test_sql.test3 VALUES (&apos;2017-01-01&apos;,&apos;10029029&apos;,&apos;1000003251&apos;,33.57);
INSERT INTO TABLE test_sql.test3 VALUES (&apos;2017-01-01&apos;,&apos;100290288&apos;,&apos;1000003252&apos;,33.57);
INSERT INTO TABLE test_sql.test3 VALUES (&apos;2017-02-02&apos;,&apos;10029088&apos;,&apos;1000003251&apos;,33.57);
INSERT INTO TABLE test_sql.test3 VALUES (&apos;2017-02-02&apos;,&apos;100290281&apos;,&apos;1000003251&apos;,33.57);
INSERT INTO TABLE test_sql.test3 VALUES (&apos;2017-02-02&apos;,&apos;100290282&apos;,&apos;1000003253&apos;,33.57);
INSERT INTO TABLE test_sql.test3 VALUES (&apos;2017-11-02&apos;,&apos;10290282&apos;,&apos;100003253&apos;,234);
INSERT INTO TABLE test_sql.test3 VALUES (&apos;2018-11-02&apos;,&apos;10290284&apos;,&apos;100003243&apos;,234);</code></pre><h3 id="2-2查询SQL-1"><a href="#2-2查询SQL-1" class="headerlink" title="2.2查询SQL"></a>2.2查询SQL</h3><pre><code>(1)
    SELECT t1.mon,
           count(t1.order_id) AS order_cnt,
           count(DISTINCT t1.user_id) AS user_cnt,
           sum(amount) AS total_amount
    FROM
      (SELECT order_id,
              user_id,
              amount,
              date_format(dt,&apos;yyyy-MM&apos;) mon
       FROM test_sql.test3
       WHERE date_format(dt,&apos;yyyy&apos;) = &apos;2017&apos;) t1
    GROUP BY t1.mon
(2)
    SELECT count(user_id)
    FROM test_sql.test3
    GROUP BY user_id
    HAVING date_format(min(dt),&apos;yyyy-MM&apos;)=&apos;2017-11&apos;;</code></pre><h1 id="第四题"><a href="#第四题" class="headerlink" title="第四题"></a>第四题</h1><h2 id="1-需求-3"><a href="#1-需求-3" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>有一个5000万的用户文件(user_id，name，age)，一个2亿记录的用户看电影的记录文件(user_id，url)，根据年龄段观看电影的次数进行排序？</code></pre><h2 id="2-实现-3"><a href="#2-实现-3" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备-3"><a href="#2-1数据准备-3" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test_sql.test4user
           (user_id string,
            name string,
            age int);

CREATE TABLE test_sql.test4log
                        (user_id string,
                        url string);

INSERT INTO TABLE test_sql.test4user VALUES(&apos;001&apos;,&apos;u1&apos;,10);
INSERT INTO TABLE test_sql.test4user VALUES(&apos;002&apos;,&apos;u2&apos;,15);   
INSERT INTO TABLE test_sql.test4user VALUES(&apos;003&apos;,&apos;u3&apos;,15);   
INSERT INTO TABLE test_sql.test4user VALUES(&apos;004&apos;,&apos;u4&apos;,20);   
INSERT INTO TABLE test_sql.test4user VALUES(&apos;005&apos;,&apos;u5&apos;,25);   
INSERT INTO TABLE test_sql.test4user VALUES(&apos;006&apos;,&apos;u6&apos;,35);   
INSERT INTO TABLE test_sql.test4user VALUES(&apos;007&apos;,&apos;u7&apos;,40);
INSERT INTO TABLE test_sql.test4user VALUES(&apos;008&apos;,&apos;u8&apos;,45);  
INSERT INTO TABLE test_sql.test4user VALUES(&apos;009&apos;,&apos;u9&apos;,50);  
INSERT INTO TABLE test_sql.test4user VALUES(&apos;0010&apos;,&apos;u10&apos;,65);  
INSERT INTO TABLE test_sql.test4log VALUES(&apos;001&apos;,&apos;url1&apos;);
INSERT INTO TABLE test_sql.test4log VALUES(&apos;002&apos;,&apos;url1&apos;);   
INSERT INTO TABLE test_sql.test4log VALUES(&apos;003&apos;,&apos;url2&apos;);   
INSERT INTO TABLE test_sql.test4log VALUES(&apos;004&apos;,&apos;url3&apos;);   
INSERT INTO TABLE test_sql.test4log VALUES(&apos;005&apos;,&apos;url3&apos;);   
INSERT INTO TABLE test_sql.test4log VALUES(&apos;006&apos;,&apos;url1&apos;);   
INSERT INTO TABLE test_sql.test4log VALUES(&apos;007&apos;,&apos;url5&apos;);
INSERT INTO TABLE test_sql.test4log VALUES(&apos;008&apos;,&apos;url7&apos;);  
INSERT INTO TABLE test_sql.test4log VALUES(&apos;009&apos;,&apos;url5&apos;);  
INSERT INTO TABLE test_sql.test4log VALUES(&apos;0010&apos;,&apos;url1&apos;); </code></pre><h3 id="2-2查询SQL-2"><a href="#2-2查询SQL-2" class="headerlink" title="2.2查询SQL"></a>2.2查询SQL</h3><pre><code>SELECT 
t2.age_phase,
sum(t1.cnt) as view_cnt
FROM

  (SELECT user_id,
          count(*) cnt
   FROM test_sql.test4log
   GROUP BY user_id) t1
JOIN
  (SELECT user_id,
          CASE WHEN age &lt;= 10 AND age &gt; 0 THEN &apos;0-10&apos; 
          WHEN age &lt;= 20 AND age &gt; 10 THEN &apos;10-20&apos;
          WHEN age &gt;20 AND age &lt;=30 THEN &apos;20-30&apos;
          WHEN age &gt;30 AND age &lt;=40 THEN &apos;30-40&apos;
          WHEN age &gt;40 AND age &lt;=50 THEN &apos;40-50&apos;
          WHEN age &gt;50 AND age &lt;=60 THEN &apos;50-60&apos;
          WHEN age &gt;60 AND age &lt;=70 THEN &apos;60-70&apos;
          ELSE &apos;70以上&apos; END as age_phase
   FROM test_sql.test4user) t2 ON t1.user_id = t2.user_id 
   GROUP BY t2.age_phase</code></pre><h1 id="第五题"><a href="#第五题" class="headerlink" title="第五题"></a>第五题</h1><h2 id="1-需求-4"><a href="#1-需求-4" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>有日志如下，请写出代码求得所有用户和活跃用户的总数及平均年龄。（活跃用户指连续两天都有访问记录的用户）
日期 用户 年龄
2019-02-11,test_1,23
2019-02-11,test_2,19
2019-02-11,test_3,39
2019-02-11,test_1,23
2019-02-11,test_3,39
2019-02-11,test_1,23
2019-02-12,test_2,19
2019-02-13,test_1,23
2019-02-15,test_2,19
2019-02-16,test_2,19</code></pre><h2 id="2-实现-4"><a href="#2-实现-4" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备-4"><a href="#2-1数据准备-4" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test5(
dt string,
user_id string,
age int)
ROW format delimited fields terminated BY &apos;,&apos;;
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-11&apos;,&apos;test_1&apos;,23);
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-11&apos;,&apos;test_2&apos;,19);
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-11&apos;,&apos;test_3&apos;,39);
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-11&apos;,&apos;test_1&apos;,23);
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-11&apos;,&apos;test_3&apos;,39);
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-11&apos;,&apos;test_1&apos;,23);
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-12&apos;,&apos;test_2&apos;,19);
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-13&apos;,&apos;test_1&apos;,23);
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-15&apos;,&apos;test_2&apos;,19);                                        
INSERT INTO TABLE test_sql.test5 VALUES (&apos;2019-02-16&apos;,&apos;test_2&apos;,19);</code></pre><h3 id="2-2查询SQL-3"><a href="#2-2查询SQL-3" class="headerlink" title="2.2查询SQL"></a>2.2查询SQL</h3><pre><code>SELECT sum(total_user_cnt) total_user_cnt,
       sum(total_user_avg_age) total_user_avg_age,
       sum(two_days_cnt) two_days_cnt,
       sum(avg_age) avg_age
FROM
  (SELECT 0 total_user_cnt,
          0 total_user_avg_age,
          count(*) AS two_days_cnt,
          cast(sum(age) / count(*) AS decimal(5,2)) AS avg_age
   FROM
     (SELECT user_id,
             max(age) age
      FROM
        (SELECT user_id,
                max(age) age
         FROM
           (SELECT user_id,
                   age,
                   date_sub(dt,rank) flag
            FROM
              (SELECT dt,
                      user_id,
                      max(age) age,
                      row_number() over(PARTITION BY user_id
                                        ORDER BY dt) rank
               FROM test_sql.test5
               GROUP BY dt,
                        user_id) t1) t2
         GROUP BY user_id,
                  flag
         HAVING count(*) &gt;=2) t3
      GROUP BY user_id) t4
   UNION ALL SELECT count(*) total_user_cnt,
                    cast(sum(age) /count(*) AS decimal(5,2)) total_user_avg_age,
                    0 two_days_cnt,
                    0 avg_age
   FROM
     (SELECT user_id,
             max(age) age
      FROM test_sql.test5
      GROUP BY user_id) t5) t6</code></pre><h1 id="第六题"><a href="#第六题" class="headerlink" title="第六题"></a>第六题</h1><h2 id="1-需求-5"><a href="#1-需求-5" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>请用sql写出所有用户中在今年10月份第一次购买商品的金额，
表ordertable字段:
(购买用户：userid，金额：money，购买时间：paymenttime(格式：2017-10-01)，订单id：orderid）</code></pre><h2 id="2-实现-5"><a href="#2-实现-5" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备-5"><a href="#2-1数据准备-5" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test_sql.test6 (
            userid string,
            money decimal(10,2),
            paymenttime string,
            orderid string);

INSERT INTO TABLE test_sql.test6 VALUES(&apos;001&apos;,100,&apos;2017-10-01&apos;,&apos;123&apos;);
INSERT INTO TABLE test_sql.test6 VALUES(&apos;001&apos;,200,&apos;2017-10-02&apos;,&apos;124&apos;);
INSERT INTO TABLE test_sql.test6 VALUES(&apos;002&apos;,500,&apos;2017-10-01&apos;,&apos;125&apos;);
INSERT INTO TABLE test_sql.test6 VALUES(&apos;001&apos;,100,&apos;2017-11-01&apos;,&apos;126&apos;);</code></pre><h3 id="2-2查询SQL-4"><a href="#2-2查询SQL-4" class="headerlink" title="2.2查询SQL"></a>2.2查询SQL</h3><pre><code>SELECT
userid,
paymenttime,
money,
orderid
from
(SELECT userid,
       money,
       paymenttime,
       orderid,
       row_number() over (PARTITION BY userid
                          ORDER BY paymenttime) rank
FROM test_sql.test6
WHERE date_format(paymenttime,&apos;yyyy-MM&apos;) = &apos;2017-10&apos;) t
WHERE rank = 1</code></pre><h1 id="第七题"><a href="#第七题" class="headerlink" title="第七题"></a>第七题</h1><h2 id="1-需求-6"><a href="#1-需求-6" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>现有图书管理数据库的三个数据模型如下：
图书（数据表名：BOOK）
    序号      字段名称    字段描述    字段类型
    1       BOOK_ID     总编号         文本
    2       SORT        分类号         文本
    3           BOOK_NAME   书名          文本
    4       WRITER      作者          文本
    5       OUTPUT      出版单位    文本
    6       PRICE       单价          数值（保留小数点后2位）
读者（数据表名：READER）
    序号      字段名称    字段描述    字段类型
    1       READER_ID   借书证号    文本
    2       COMPANY     单位          文本
    3       NAME        姓名          文本
    4       SEX         性别          文本
    5       GRADE       职称          文本
    6       ADDR        地址          文本
借阅记录（数据表名：BORROW LOG）
    序号      字段名称        字段描述    字段类型
    1       READER_ID       借书证号    文本
    2       BOOK_ID          总编号         文本
    3       BORROW_DATE      借书日期    日期
（1）创建图书管理库的图书、读者和借阅三个基本表的表结构。请写出建表语句。
（2）找出姓李的读者姓名（NAME）和所在单位（COMPANY）。
（3）查找“高等教育出版社”的所有图书名称（BOOK_NAME）及单价（PRICE），结果按单价降序排序。
（4）查找价格介于10元和20元之间的图书种类(SORT）出版单位（OUTPUT）和单价（PRICE），结果按出版单位（OUTPUT）和单价（PRICE）升序排序。
（5）查找所有借了书的读者的姓名（NAME）及所在单位（COMPANY）。
（6）求”科学出版社”图书的最高单价、最低单价、平均单价。
（7）找出当前至少借阅了2本图书（大于等于2本）的读者姓名及其所在单位。
（8）考虑到数据安全的需要，需定时将“借阅记录”中数据进行备份，请使用一条SQL语句，在备份用户bak下创建与“借阅记录”表结构完全一致的数据表BORROW_LOG_BAK.井且将“借阅记录”中现有数据全部复制到BORROW_L0G_ BAK中。
（9）现在需要将原Oracle数据库中数据迁移至Hive仓库，请写出“图书”在Hive中的建表语句（Hive实现，提示：列分隔符|；数据表数据需要外部导入：分区分别以month＿part、day＿part 命名）
（10）Hive中有表A，现在需要将表A的月分区　201505　中　user＿id为20000的user＿dinner字段更新为bonc8920，其他用户user＿dinner字段数据不变，请列出更新的方法步骤。（Hive实现，提示：Hlive中无update语法，请通过其他办法进行数据更新）</code></pre><h2 id="2-实现-6"><a href="#2-实现-6" class="headerlink" title="2.实现"></a>2.实现</h2><pre><code>(1)

-- 创建图书表book

CREATE TABLE test_sql.book(book_id string,
                           `SORT` string,
                           book_name string,
                           writer string,
                           OUTPUT string,
                           price decimal(10,2));
INSERT INTO TABLE test_sql.book VALUES (&apos;001&apos;,&apos;TP391&apos;,&apos;信息处理&apos;,&apos;author1&apos;,&apos;机械工业出版社&apos;,&apos;20&apos;);
INSERT INTO TABLE test_sql.book VALUES (&apos;002&apos;,&apos;TP392&apos;,&apos;数据库&apos;,&apos;author12&apos;,&apos;科学出版社&apos;,&apos;15&apos;);
INSERT INTO TABLE test_sql.book VALUES (&apos;003&apos;,&apos;TP393&apos;,&apos;计算机网络&apos;,&apos;author3&apos;,&apos;机械工业出版社&apos;,&apos;29&apos;);
INSERT INTO TABLE test_sql.book VALUES (&apos;004&apos;,&apos;TP399&apos;,&apos;微机原理&apos;,&apos;author4&apos;,&apos;科学出版社&apos;,&apos;39&apos;);
INSERT INTO TABLE test_sql.book VALUES (&apos;005&apos;,&apos;C931&apos;,&apos;管理信息系统&apos;,&apos;author5&apos;,&apos;机械工业出版社&apos;,&apos;40&apos;);
INSERT INTO TABLE test_sql.book VALUES (&apos;006&apos;,&apos;C932&apos;,&apos;运筹学&apos;,&apos;author6&apos;,&apos;科学出版社&apos;,&apos;55&apos;);


-- 创建读者表reader

CREATE TABLE test_sql.reader (reader_id string,
                              company string,
                              name string,
                              sex string,
                              grade string,
                              addr string);
INSERT INTO TABLE test_sql.reader VALUES (&apos;0001&apos;,&apos;阿里巴巴&apos;,&apos;jack&apos;,&apos;男&apos;,&apos;vp&apos;,&apos;addr1&apos;);
INSERT INTO TABLE test_sql.reader VALUES (&apos;0002&apos;,&apos;百度&apos;,&apos;robin&apos;,&apos;男&apos;,&apos;vp&apos;,&apos;addr2&apos;);
INSERT INTO TABLE test_sql.reader VALUES (&apos;0003&apos;,&apos;腾讯&apos;,&apos;tony&apos;,&apos;男&apos;,&apos;vp&apos;,&apos;addr3&apos;);
INSERT INTO TABLE test_sql.reader VALUES (&apos;0004&apos;,&apos;京东&apos;,&apos;jasper&apos;,&apos;男&apos;,&apos;cfo&apos;,&apos;addr4&apos;);
INSERT INTO TABLE test_sql.reader VALUES (&apos;0005&apos;,&apos;网易&apos;,&apos;zhangsan&apos;,&apos;女&apos;,&apos;ceo&apos;,&apos;addr5&apos;);
INSERT INTO TABLE test_sql.reader VALUES (&apos;0006&apos;,&apos;搜狐&apos;,&apos;lisi&apos;,&apos;女&apos;,&apos;ceo&apos;,&apos;addr6&apos;);

-- 创建借阅记录表borrow_log

CREATE TABLE test_sql.borrow_log(reader_id string,
                                 book_id string,
                                 borrow_date string);

INSERT INTO TABLE test_sql.borrow_log VALUES (&apos;0001&apos;,&apos;002&apos;,&apos;2019-10-14&apos;);
INSERT INTO TABLE test_sql.borrow_log VALUES (&apos;0002&apos;,&apos;001&apos;,&apos;2019-10-13&apos;);
INSERT INTO TABLE test_sql.borrow_log VALUES (&apos;0003&apos;,&apos;005&apos;,&apos;2019-09-14&apos;);
INSERT INTO TABLE test_sql.borrow_log VALUES (&apos;0004&apos;,&apos;006&apos;,&apos;2019-08-15&apos;);
INSERT INTO TABLE test_sql.borrow_log VALUES (&apos;0005&apos;,&apos;003&apos;,&apos;2019-10-10&apos;);
INSERT INTO TABLE test_sql.borrow_log VALUES (&apos;0006&apos;,&apos;004&apos;,&apos;2019-17-13&apos;);

(2)
    SELECT name,
           company
    FROM test_sql.reader
    WHERE name LIKE &apos;李%&apos;;
(3)
    SELECT book_name,
           price
    FROM test_sql.book
    WHERE OUTPUT = &quot;高等教育出版社&quot;
    ORDER BY price DESC;
(4)
    SELECT sort,
           output,
           price
    FROM test_sql.book
    WHERE price &gt;= 10 and price &lt;= 20
    ORDER BY output,price ;
(5)
    SELECT b.name,
           b.company
    FROM test_sql.borrow_log a
    JOIN test_sql.reader b ON a.reader_id = b.reader_id;
(6)
    SELECT max(price),
           min(price),
           avg(price)
    FROM test_sql.book
    WHERE OUTPUT = &apos;科学出版社&apos;;
(7)
    SELECT b.name,
           b.company
    FROM
      (SELECT reader_id
       FROM test_sql.borrow_log
       GROUP BY reader_id
       HAVING count(*) &gt;= 2) a
    JOIN test_sql.reader b ON a.reader_id = b.reader_id;

(8)
    CREATE TABLE test_sql.borrow_log_bak AS
    SELECT *
    FROM test_sql.borrow_log;
(9)
    CREATE TABLE book_hive ( 
    book_id string,
    SORT string, 
    book_name string,
    writer string, 
    OUTPUT string, 
    price DECIMAL ( 10, 2 ) )
    partitioned BY ( month_part string, day_part string )
    ROW format delimited FIELDS TERMINATED BY &apos;\\|&apos; stored AS textfile;
(10)
    方式1：配置hive支持事务操作，分桶表，orc存储格式
    方式2：第一步找到要更新的数据，将要更改的字段替换为新的值，第二步找到不需要更新的数据，第三步将上两步的数据插入一张新表中。</code></pre><h1 id="第八题"><a href="#第八题" class="headerlink" title="第八题"></a>第八题</h1><h2 id="1-需求-7"><a href="#1-需求-7" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>有一个线上服务器访问日志格式如下（用sql答题）
时间                    接口                         ip地址
2016-11-09 14:22:05        /api/user/login                110.23.5.33
2016-11-09 14:23:10        /api/user/detail            57.3.2.16
2016-11-09 15:59:40        /api/user/login                200.6.5.166
… …
求11月9号下午14点（14-15点），访问/api/user/login接口的top10的ip地址</code></pre><h2 id="2-实现-7"><a href="#2-实现-7" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备-6"><a href="#2-1数据准备-6" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test_sql.test8(`date` string,
                interface string,
                ip string);

INSERT INTO TABLE test_sql.test8 VALUES (&apos;2016-11-09 11:22:05&apos;,&apos;/api/user/login&apos;,&apos;110.23.5.23&apos;);
INSERT INTO TABLE test_sql.test8 VALUES (&apos;2016-11-09 11:23:10&apos;,&apos;/api/user/detail&apos;,&apos;57.3.2.16&apos;);
INSERT INTO TABLE test_sql.test8 VALUES (&apos;2016-11-09 23:59:40&apos;,&apos;/api/user/login&apos;,&apos;200.6.5.166&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 11:14:23&apos;,&apos;/api/user/login&apos;,&apos;136.79.47.70&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 11:15:23&apos;,&apos;/api/user/detail&apos;,&apos;94.144.143.141&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 11:16:23&apos;,&apos;/api/user/login&apos;,&apos;197.161.8.206&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 12:14:23&apos;,&apos;/api/user/detail&apos;,&apos;240.227.107.145&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 13:14:23&apos;,&apos;/api/user/login&apos;,&apos;79.130.122.205&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 14:14:23&apos;,&apos;/api/user/detail&apos;,&apos;65.228.251.189&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 14:15:23&apos;,&apos;/api/user/detail&apos;,&apos;245.23.122.44&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 14:17:23&apos;,&apos;/api/user/detail&apos;,&apos;22.74.142.137&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 14:19:23&apos;,&apos;/api/user/detail&apos;,&apos;54.93.212.87&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 14:20:23&apos;,&apos;/api/user/detail&apos;,&apos;218.15.167.248&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 14:24:23&apos;,&apos;/api/user/detail&apos;,&apos;20.117.19.75&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 15:14:23&apos;,&apos;/api/user/login&apos;,&apos;183.162.66.97&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 16:14:23&apos;,&apos;/api/user/login&apos;,&apos;108.181.245.147&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 14:17:23&apos;,&apos;/api/user/login&apos;,&apos;22.74.142.137&apos;);
INSERT INTO TABLE test_sql.test8 VALUES(&apos;2016-11-09 14:19:23&apos;,&apos;/api/user/login&apos;,&apos;22.74.142.137&apos;);</code></pre><h3 id="2-2查询SQL-5"><a href="#2-2查询SQL-5" class="headerlink" title="2.2查询SQL"></a>2.2查询SQL</h3><pre><code>SELECT ip,
       count(*) AS cnt
FROM test_sql.test8
WHERE date_format(date,&apos;yyyy-MM-dd HH&apos;) &gt;= &apos;2016-11-09 14&apos;
  AND date_format(date,&apos;yyyy-MM-dd HH&apos;) &lt; &apos;2016-11-09 15&apos;
  AND interface=&apos;/api/user/login&apos;
GROUP BY ip
ORDER BY cnt desc
LIMIT 10;</code></pre><h1 id="第九题"><a href="#第九题" class="headerlink" title="第九题"></a>第九题</h1><h2 id="1-需求-8"><a href="#1-需求-8" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>有一个充值日志表credit_log，字段如下：

    `dist_id` int  &apos;区组id&apos;,
    `account` string  &apos;账号&apos;,
    `money` int   &apos;充值金额&apos;,
    `create_time` string  &apos;订单时间&apos;

请写出SQL语句，查询充值日志表2019年01月02号每个区组下充值额最大的账号，要求结果：
区组id，账号，金额，充值时间</code></pre><h2 id="2-实现-8"><a href="#2-实现-8" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备-7"><a href="#2-1数据准备-7" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test_sql.test9(
                            dist_id string COMMENT &apos;区组id&apos;,
                            account string COMMENT &apos;账号&apos;,
                           `money` decimal(10,2) COMMENT &apos;充值金额&apos;,
                            create_time string COMMENT &apos;订单时间&apos;);

INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;11&apos;,100006,&apos;2019-01-02 13:00:01&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;22&apos;,110000,&apos;2019-01-02 13:00:02&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;33&apos;,102000,&apos;2019-01-02 13:00:03&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;44&apos;,100300,&apos;2019-01-02 13:00:04&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;55&apos;,100040,&apos;2019-01-02 13:00:05&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;66&apos;,100005,&apos;2019-01-02 13:00:06&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;77&apos;,180000,&apos;2019-01-03 13:00:07&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;88&apos;,106000,&apos;2019-01-02 13:00:08&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;99&apos;,100400,&apos;2019-01-02 13:00:09&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;12&apos;,100030,&apos;2019-01-02 13:00:10&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;13&apos;,100003,&apos;2019-01-02 13:00:20&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;14&apos;,100020,&apos;2019-01-02 13:00:30&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;15&apos;,100500,&apos;2019-01-02 13:00:40&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;16&apos;,106000,&apos;2019-01-02 13:00:50&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;1&apos;,&apos;17&apos;,100800,&apos;2019-01-02 13:00:59&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;2&apos;,&apos;18&apos;,100800,&apos;2019-01-02 13:00:11&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;2&apos;,&apos;19&apos;,100030,&apos;2019-01-02 13:00:12&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;2&apos;,&apos;10&apos;,100000,&apos;2019-01-02 13:00:13&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;2&apos;,&apos;45&apos;,100010,&apos;2019-01-02 13:00:14&apos;);
INSERT INTO TABLE test_sql.test9 VALUES (&apos;2&apos;,&apos;78&apos;,100070,&apos;2019-01-02 13:00:15&apos;);</code></pre><h3 id="2-2查询SQL-6"><a href="#2-2查询SQL-6" class="headerlink" title="2.2查询SQL"></a>2.2查询SQL</h3><pre><code>  WITH TEMP AS
  (SELECT dist_id,
          account,
          sum(`money`) sum_money
   FROM test_sql.test9
   WHERE date_format(create_time,&apos;yyyy-MM-dd&apos;) = &apos;2019-01-02&apos;
   GROUP BY dist_id,
            account)
SELECT t1.dist_id,
       t1.account,
       t1.sum_money
FROM
  (SELECT temp.dist_id,
          temp.account,
          temp.sum_money,
          rank() over(partition BY temp.dist_id
                      ORDER BY temp.sum_money DESC) ranks
   FROM TEMP) t1
WHERE ranks = 1</code></pre><h1 id="第十题"><a href="#第十题" class="headerlink" title="第十题"></a>第十题</h1><h2 id="1-需求-9"><a href="#1-需求-9" class="headerlink" title="1.需求"></a>1.需求</h2><pre><code>有一个账号表如下，请写出SQL语句，查询各自区组的money排名前十的账号（分组取前10）
        dist_id string  &apos;区组id&apos;,
        account string  &apos;账号&apos;,
        gold     int    &apos;金币&apos;</code></pre><h2 id="2-实现-9"><a href="#2-实现-9" class="headerlink" title="2.实现"></a>2.实现</h2><h3 id="2-1数据准备-8"><a href="#2-1数据准备-8" class="headerlink" title="2.1数据准备"></a>2.1数据准备</h3><pre><code>CREATE TABLE test_sql.test10(
    `dist_id` string COMMENT &apos;区组id&apos;,
    `account` string COMMENT &apos;账号&apos;,
    `gold` int COMMENT &apos;金币&apos;
);

INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;77&apos;,18);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;88&apos;,106);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;99&apos;,10);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;12&apos;,13);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;13&apos;,14);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;14&apos;,25);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;15&apos;,36);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;16&apos;,12);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;1&apos;,&apos;17&apos;,158);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;2&apos;,&apos;18&apos;,12);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;2&apos;,&apos;19&apos;,44);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;2&apos;,&apos;10&apos;,66);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;2&apos;,&apos;45&apos;,80);
INSERT INTO TABLE test_sql.test10 VALUES (&apos;2&apos;,&apos;78&apos;,98);</code></pre><h3 id="2-2查询SQL-7"><a href="#2-2查询SQL-7" class="headerlink" title="2.2查询SQL"></a>2.2查询SQL</h3><pre><code>SELECT dist_id,
       account,
       gold
FROM
  (SELECT dist_id,
          account,
          gold,
          row_number () over (PARTITION BY dist_id
                              ORDER BY gold DESC) rank
   FROM test_sql.test10) t
WHERE rank &lt;= 10</code></pre></div><div class="recommended_posts"><h3>相关推荐 ☟</h3><li><a href="https://jiamaoxiang.top/2019/09/26/Flink的Window-Function介绍/" target="_blank">Flink的Window Function介绍</a></li><li><a href="https://jiamaoxiang.top/2019/08/29/Impala使用的端口/" target="_blank">Impala使用的端口</a></li><li><a href="https://jiamaoxiang.top/2019/08/28/Azkaban安装部署/" target="_blank">Azkaban安装部署</a></li><li><a href="https://jiamaoxiang.top/2019/08/27/Flink的数据类型/" target="_blank">Flink的数据类型</a></li></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Jia MaoXiang</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2019/10/15/经典Hive-SQL面试题/">https://jiamaoxiang.top/2019/10/15/经典Hive-SQL面试题/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本文为博主原创文章，遵循CC BY-SA 4.0版权协议，转载请附上原文出处链接和本声明</li></ul></div><br><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://jiamaoxiang.top/2019/10/15/经典Hive-SQL面试题/" data-id="ck1ra82ig001ogg7qiqegy0d6" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACK0lEQVR42u3aWW7DMAwFwN7/0ukBGjmPpFPA0vgrqDdNCjBc9PMTH6/F8ffs6i/XT67e1TwwMDAey3hdHqtrrp9QXWj+3iUVAwPjAEYSCq/vur6+967CczAwMDDiRLAamldPw8DAwLg3CPaKz7wYxsDAwOgFwWrAzZf79VocAwPjgYw8OP7/56/MNzAwMB7FeBWP6lCzl/CVV4WBgbE1Iw9w1wlZMuyspoPl9WBgYGzNqBa0k1ZaMgRNrrxhixgGBsajGNWl95B5opkH6De/GxgYGNsxJs39SWOuN85cvgsDA2NrRn46eUFSyubttl7gxsDA2I8x2VRRBedfRLl4xsDAOICRt8PKyVkxKayuYZnhYmBgbMSobn3Iy9S8lK0OR8uTWAwMjIcz8rIzAfcK0Woh/eH/gIGBsR2jutGhN9pMnnnbnhEMDIztGPmoMm+95YGyOi79kBpiYGBsykgWlBz5mKE3NG3+YmBgYGzEmG+wyBtt1bZa9evAwMDYlZEE3OoLqmlidSD65koMDIwDGNUwOgm+k7uWZzEwMI5hzJd776ggH6NiYGCcw5g06e7dbJFPKjEwMPZm9AYASUuuF5TzEhoDA+Mcxjy8ToajvRbeZD0YGBjPZeQbKeZ9+BsyWQwMjIMZkzZcNRxPNoF9KGUxMDAwgmK113q7IRnFwMDAaG35mjfpkusxMDDOYSRFbLLEvLk/abFhYGCcxpjnXfOBQa9th4GBcQDjF0W/LLp3IgGbAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/Hive/">Hive</a></div><div class="post-nav"><a class="next" href="/2019/09/26/Flink的Window-Function介绍/">Flink的Window Function介绍</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar-toc"><div class="stoc-article" id="sidebar-stoc"><strong class="stoc-title"><i class="fa fa-list-ul"> 目录</i></strong><div class="toc-nav" id="stoc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第一题："><span class="toc-number">1.</span> <span class="toc-text">第一题：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求"><span class="toc-number">1.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现"><span class="toc-number">1.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2查询SQL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二题："><span class="toc-number">2.</span> <span class="toc-text">第二题：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-1"><span class="toc-number">2.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-1"><span class="toc-number">2.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL实现"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2查询SQL实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三题"><span class="toc-number">3.</span> <span class="toc-text">第三题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-2"><span class="toc-number">3.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-2"><span class="toc-number">3.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备-2"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL-1"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2查询SQL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第四题"><span class="toc-number">4.</span> <span class="toc-text">第四题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-3"><span class="toc-number">4.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-3"><span class="toc-number">4.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备-3"><span class="toc-number">4.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL-2"><span class="toc-number">4.2.2.</span> <span class="toc-text">2.2查询SQL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第五题"><span class="toc-number">5.</span> <span class="toc-text">第五题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-4"><span class="toc-number">5.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-4"><span class="toc-number">5.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备-4"><span class="toc-number">5.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL-3"><span class="toc-number">5.2.2.</span> <span class="toc-text">2.2查询SQL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第六题"><span class="toc-number">6.</span> <span class="toc-text">第六题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-5"><span class="toc-number">6.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-5"><span class="toc-number">6.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备-5"><span class="toc-number">6.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL-4"><span class="toc-number">6.2.2.</span> <span class="toc-text">2.2查询SQL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第七题"><span class="toc-number">7.</span> <span class="toc-text">第七题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-6"><span class="toc-number">7.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-6"><span class="toc-number">7.2.</span> <span class="toc-text">2.实现</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第八题"><span class="toc-number">8.</span> <span class="toc-text">第八题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-7"><span class="toc-number">8.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-7"><span class="toc-number">8.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备-6"><span class="toc-number">8.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL-5"><span class="toc-number">8.2.2.</span> <span class="toc-text">2.2查询SQL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第九题"><span class="toc-number">9.</span> <span class="toc-text">第九题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-8"><span class="toc-number">9.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-8"><span class="toc-number">9.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备-7"><span class="toc-number">9.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL-6"><span class="toc-number">9.2.2.</span> <span class="toc-text">2.2查询SQL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第十题"><span class="toc-number">10.</span> <span class="toc-text">第十题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-需求-9"><span class="toc-number">10.1.</span> <span class="toc-text">1.需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实现-9"><span class="toc-number">10.2.</span> <span class="toc-text">2.实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1数据准备-8"><span class="toc-number">10.2.1.</span> <span class="toc-text">2.1数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2查询SQL-7"><span class="toc-number">10.2.2.</span> <span class="toc-text">2.2查询SQL</span></a></li></ol></li></ol></li></ol></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 - 2019 <a href="/." rel="nofollow">Jmx's Blog.</a>All rights reserved.<br>Thoughts on technology, life and everything else.</div></div></div><script type="text/javascript" src="/js/toc.js?v=0.0.0"></script><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="100,99,98" opacity="0.5" zindex="0.7" count="150" src="//lib.baomitu.com/canvas-nest.js/2.0.4/canvas-nest.umd.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>